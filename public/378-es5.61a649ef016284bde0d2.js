!function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=a(t);if(e){var s=a(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return r(this,i)}}function r(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkbdp_client=self.webpackChunkbdp_client||[]).push([[378],{85378:function(t,r,a){a.r(r),a.d(r,{ResultModule:function(){return xa}});var o,l=a(38583),u=a(3679),c=a(51095),d=a(42542),g=a(90171),f=a(49983),p=a(65939),h=a(76627),m=a(32789),Z=a(11494),x=a(11436),v=a(1769),w=a(99692),k=a(37716),b=a(72458),T=a(39490),y=a(46237),A=a(75319),q=a(22759),_=a(45435),C=["primaryValueBar"],S=(0,b.pj)(function(){return function t(e){s(this,t),this._elementRef=e}}(),"primary"),U=new k.OlP("mat-progress-bar-location",{providedIn:"root",factory:function(){var t=(0,k.f3M)(l.K0),e=t?t.location:null;return{getPathname:function(){return e?e.pathname+e.search:""}}}}),R=0,N=((o=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(a,t);var r=n(a);function a(t,e,i,n){var o;s(this,a),(o=r.call(this,t))._ngZone=e,o._animationMode=i,o._isNoopAnimation=!1,o._value=0,o._bufferValue=0,o.animationEnd=new k.vpe,o._animationEndSubscription=A.w.EMPTY,o.mode="determinate",o.progressbarId="mat-progress-bar-"+R++;var l=n?n.getPathname().split("#")[0]:"";return o._rectangleFillValue="url('".concat(l,"#").concat(o.progressbarId,"')"),o._isNoopAnimation="NoopAnimations"===i,o}return e(a,[{key:"value",get:function(){return this._value},set:function(t){this._value=P((0,T.su)(t)||0)}},{key:"bufferValue",get:function(){return this._bufferValue},set:function(t){this._bufferValue=P(t||0)}},{key:"_primaryTransform",value:function(){return{transform:"scale3d(".concat(this.value/100,", 1, 1)")}}},{key:"_bufferTransform",value:function(){return"buffer"===this.mode?{transform:"scale3d(".concat(this.bufferValue/100,", 1, 1)")}:null}},{key:"ngAfterViewInit",value:function(){var t=this;this._ngZone.runOutsideAngular(function(){var e=t._primaryValueBar.nativeElement;t._animationEndSubscription=(0,q.R)(e,"transitionend").pipe((0,_.h)(function(t){return t.target===e})).subscribe(function(){("determinate"===t.mode||"buffer"===t.mode)&&t._ngZone.run(function(){return t.animationEnd.next({value:t.value})})})})}},{key:"ngOnDestroy",value:function(){this._animationEndSubscription.unsubscribe()}}]),a}(S)).\u0275fac=function(t){return new(t||o)(k.Y36(k.SBq),k.Y36(k.R0b),k.Y36(y.Qb,8),k.Y36(U,8))},o.\u0275cmp=k.Xpm({type:o,selectors:[["mat-progress-bar"]],viewQuery:function(t,e){var i;1&t&&k.Gf(C,5),2&t&&k.iGM(i=k.CRH())&&(e._primaryValueBar=i.first)},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(t,e){2&t&&(k.uIk("aria-valuenow","indeterminate"===e.mode||"query"===e.mode?null:e.value)("mode",e.mode),k.ekj("_mat-animation-noopable",e._isNoopAnimation))},inputs:{color:"color",mode:"mode",value:"value",bufferValue:"bufferValue"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[k.qOj],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(t,e){1&t&&(k.TgZ(0,"div",0),k.O4$(),k.TgZ(1,"svg",1),k.TgZ(2,"defs"),k.TgZ(3,"pattern",2),k._UZ(4,"circle",3),k.qZA(),k.qZA(),k._UZ(5,"rect",4),k.qZA(),k.kcU(),k._UZ(6,"div",5),k._UZ(7,"div",6,7),k._UZ(9,"div",8),k.qZA()),2&t&&(k.xp6(3),k.Q6J("id",e.progressbarId),k.xp6(2),k.uIk("fill",e._rectangleFillValue),k.xp6(1),k.Q6J("ngStyle",e._bufferTransform()),k.xp6(1),k.Q6J("ngStyle",e._primaryTransform()))},directives:[l.PC],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),o);function P(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return Math.max(e,Math.min(i,t))}var J=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({imports:[[l.ez,b.BQ],b.BQ]}),t}(),I=a(7539),Q=a(85855),D=a(58846),Y=a(39418),j=a(19918),M=a(16738),L=function(){function t(e){s(this,t),this.exec="",this.index=e.index,this.process=String(e.process),this.taskName=String(e["task name"]),this.pid=String(e.pid),this.image=String(e.image),this.command=e.command?String(e.command):null,this.startTime="null"!==e["start time"]?M(new Date(e["start time"])):null,this.endTime="null"!==e["end time"]?M(new Date(e["end time"])):null,this.cpus=parseFloat(e.cpus),this.memory=String(e.memory),this.nodes=parseFloat(e.nodes),this.exitCode=void 0!==e["exit code"]?String(e["exit code"]):null,this.proxy=e.proxy&&"null"!==e.proxy?JSON.parse(e.proxy):null}return e(t,[{key:"duration",get:function(){return null!=this.startTime&&null!=this.endTime?this.endTime.diff(this.startTime,"hours"):null}},{key:"isFull",get:function(){return!(!this.command||!this.exitCode)}}]),t}(),O=a(20945),B=a(25917),F=a(11222),$=a(43190),E=a(354),z=a(43037),H=a(38864),V=a(22238),X=a(15128),W=a(89876);function K(t,e){1&t&&(k.ynx(0),k._uU(1,"[Optional]"),k.BQk())}function G(t,e){1&t&&(k.ynx(0),k._uU(1,"[Hidden]"),k.BQk())}function tt(t,e){1&t&&(k.TgZ(0,"span",17),k._uU(1,"Static value"),k.qZA())}function et(t,e){1&t&&(k.TgZ(0,"span",18),k._uU(1,"Input value"),k.qZA())}function it(t,e){1&t&&(k.TgZ(0,"span",19),k._uU(1,"List"),k.qZA())}function nt(t,e){1&t&&(k.TgZ(0,"span",20),k._uU(1,"Input file"),k.qZA())}function rt(t,e){1&t&&(k.TgZ(0,"span",21),k._uU(1,"Output file"),k.qZA())}var at=function(t){return["/dataFile",t,"info"]},st=function(t,e){return{"fa-folder":t,"fa-file-text-o":e}};function ot(t,e){if(1&t&&(k.TgZ(0,"div"),k.TgZ(1,"a",23),k._UZ(2,"i",24),k.TgZ(3,"span"),k.TgZ(4,"u",25),k._uU(5),k.qZA(),k.TgZ(6,"b"),k._uU(7),k.qZA(),k.TgZ(8,"u",25),k._uU(9),k.qZA(),k.qZA(),k.qZA(),k.TgZ(10,"a",26),k._UZ(11,"span",27),k.qZA(),k.qZA()),2&t){var i=k.oxw(2).$implicit;k.xp6(1),k.Q6J("routerLink",k.VKq(8,at,i.value.id)),k.xp6(1),k.Q6J("ngClass",k.WLB(10,st,"Folder"===i.value.format,"Folder"!==i.value.format)),k.xp6(1),k.ekj("text-success","Folder"===i.value.format),k.xp6(2),k.Oqu(i.value.prefix),k.xp6(2),k.Oqu(i.value.name),k.xp6(2),k.Oqu(i.value.suffix),k.xp6(1),k.Q6J("routerLink",k.VKq(13,at,i.value.id))}}function lt(t,e){if(1&t&&(k.TgZ(0,"small",25),k._uU(1),k.qZA()),2&t){var i=k.oxw(3).$implicit;k.xp6(1),k.Oqu(i.value)}}function ut(t,e){if(1&t&&(k.TgZ(0,"div",22),k._uU(1," File not found. (could have been deleted.)"),k._UZ(2,"br"),k.YNc(3,lt,2,1,"small",28),k.qZA()),2&t){var i=k.oxw(5);k.xp6(3),k.Q6J("ngIf",i.currentUser&&i.currentUser.auths.bdp>=3)}}function ct(t,e){if(1&t&&(k.TgZ(0,"div",22),k.YNc(1,ot,12,15,"div",9),k.YNc(2,ut,4,1,"div",16),k.qZA()),2&t){var i=k.oxw().$implicit;k.xp6(1),k.Q6J("ngIf",i.value.status>=0&&i.value.id),k.xp6(1),k.Q6J("ngIf",!i.value.id)}}function dt(t,e){if(1&t&&(k.TgZ(0,"div"),k.TgZ(1,"strong"),k._uU(2),k.qZA(),k.qZA()),2&t){var i=k.oxw().$implicit;k.xp6(2),k.Oqu(i.value)}}function gt(t,e){if(1&t&&(k.TgZ(0,"div"),k.TgZ(1,"strong"),k._uU(2),k.qZA(),k.qZA()),2&t){var i=k.oxw().$implicit;k.xp6(2),k.Oqu(i.value.join(i.arg.listSplitter))}}var ft=function(){return["static","value"]};function pt(t,e){if(1&t&&(k.TgZ(0,"tr",8),k.TgZ(1,"td",5),k.YNc(2,K,2,0,"ng-container",9),k.YNc(3,G,2,0,"ng-container",9),k.TgZ(4,"b"),k._uU(5),k.qZA(),k.qZA(),k.TgZ(6,"td"),k.ynx(7,10),k.YNc(8,tt,2,0,"span",11),k.YNc(9,et,2,0,"span",12),k.YNc(10,it,2,0,"span",13),k.YNc(11,nt,2,0,"span",14),k.YNc(12,rt,2,0,"span",15),k.BQk(),k.qZA(),k.TgZ(13,"td"),k.YNc(14,ct,3,2,"div",16),k.YNc(15,dt,3,1,"div",9),k.YNc(16,gt,3,1,"div",9),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(3);k.Q6J("ngClass",n.getRowStyleByArgType(null==i.arg?null:i.arg.type)),k.xp6(2),k.Q6J("ngIf",i.arg.optional),k.xp6(1),k.Q6J("ngIf",i.arg.hidden),k.xp6(2),k.Oqu(i.arg.name),k.xp6(2),k.Q6J("ngSwitch",null==i.arg?null:i.arg.type),k.xp6(1),k.Q6J("ngSwitchCase","static"),k.xp6(1),k.Q6J("ngSwitchCase","value"),k.xp6(1),k.Q6J("ngSwitchCase","list"),k.xp6(1),k.Q6J("ngSwitchCase","inFile"),k.xp6(1),k.Q6J("ngSwitchCase","outFile"),k.xp6(2),k.Q6J("ngIf","inFile"===(null==i.arg?null:i.arg.type)||"outFile"===(null==i.arg?null:i.arg.type)),k.xp6(1),k.Q6J("ngIf",k.DdM(13,ft).indexOf(null==i.arg?null:i.arg.type)>=0),k.xp6(1),k.Q6J("ngIf","list"===(null==i.arg?null:i.arg.type))}}function ht(t,e){if(1&t&&(k.TgZ(0,"table",3),k.TgZ(1,"thead",4),k.TgZ(2,"tr"),k.TgZ(3,"th",5),k._uU(4,"Name"),k.qZA(),k.TgZ(5,"th",6),k._uU(6,"Type"),k.qZA(),k.TgZ(7,"th",5),k._uU(8,"Value"),k.qZA(),k.qZA(),k.qZA(),k.TgZ(9,"tbody"),k.YNc(10,pt,17,14,"tr",7),k.qZA(),k.qZA()),2&t){var i=k.oxw(2);k.xp6(10),k.Q6J("ngForOf",i.displayArguments())}}function mt(t,e){if(1&t&&(k.TgZ(0,"mat-expansion-panel",1),k.TgZ(1,"mat-expansion-panel-header"),k.TgZ(2,"mat-panel-title"),k._uU(3," Arguments "),k.qZA(),k.TgZ(4,"mat-panel-description"),k._uU(5," Arguments used to generate this result "),k.qZA(),k.qZA(),k.YNc(6,ht,11,1,"ng-template",2),k.qZA()),2&t){var i=k.oxw();k.Q6J("expanded",i.expanded)}}var Zt=function(){var t=function(){function t(){s(this,t),this.expanded=!1}return e(t,[{key:"ngOnInit",value:function(){}},{key:"getRowStyleByArgType",value:function(t){return{"table-secondary":"value"===t,"table-white":"static"===t,"table-primary":"inFile"===t,"table-info":"list"===t,"table-success":"outFile"===t,"table-danger":!1}}},{key:"displayArguments",value:function(){var t=this,e=[];if(!this.theResult)return[];if(this.theResult.arguments)for(var i=function(i){var n=void 0,r=(n=t.theResult.taskSnapshot.arguments[i]).type||Object.keys(t.theResult.arguments[i])[0],a="";if(t.theResult.arguments[i]&&t.theResult.arguments[i][r]&&(a=t.theResult.arguments[i][r]),n.type||(n.type=r),"inFile"===r){var s=t.theResult.inFiles.filter(function(t){var e=t.id,i=a.split(/[\\/]/).pop();return a.indexOf(e)>=0||a===t.path||a===t.realPath||i===e})[0];s&&(a=s)}else if("outFile"===r){var o=t.theResult.outFiles.filter(function(t){var e=t.id,i=a.split(/[\\/]/).pop();return a.indexOf(e)>=0||a===t.path||a===t.realPath||i===e})[0];o?a=o:t.parent&&((o=t.parent.outFiles.filter(function(t){var e=t.id,i=a.split(/[\\/]/).pop();return a.indexOf(e)>=0||a===t.path||a===t.realPath||i===e})[0])&&(a=o))}e.push({arg:n,value:a})},n=0;n<this.theResult.arguments.length;n++)i(n);return e}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=k.Xpm({type:t,selectors:[["display-arguments"]],inputs:{theResult:"theResult",parent:"parent",currentUser:"currentUser",expanded:"expanded"},decls:1,vars:1,consts:[["style","background-color: rgba(255,255,255, 0.4)",3,"expanded",4,"ngIf"],[2,"background-color","rgba(255,255,255, 0.4)",3,"expanded"],["matExpansionPanelContent",""],[1,"table","table-hover","table-bordered","table-sm"],[1,"table-dark"],[1,"text-center"],[1,"text-center",2,"width","100px"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[4,"ngIf"],[3,"ngSwitch"],["class","badge bg-dark",4,"ngSwitchCase"],["class","badge bg-secondary",4,"ngSwitchCase"],["class","badge bg-info",4,"ngSwitchCase"],["class","badge bg-primary",4,"ngSwitchCase"],["class","badge bg-success",4,"ngSwitchCase"],["style","word-break:break-all;",4,"ngIf"],[1,"badge","bg-dark"],[1,"badge","bg-secondary"],[1,"badge","bg-info"],[1,"badge","bg-primary"],[1,"badge","bg-success"],[2,"word-break","break-all"],[3,"routerLink"],[1,"me-2","fa",2,"font-size","14px",3,"ngClass"],[1,"text-muted"],["target","_blank",1,"ms-3",3,"routerLink"],[1,"fas","fa-external-link-alt"],["class","text-muted",4,"ngIf"]],template:function(t,e){1&t&&k.YNc(0,mt,7,1,"mat-expansion-panel",0),2&t&&k.Q6J("ngIf",e.theResult)},directives:[l.O5,g.ib,g.yz,g.yK,g.u4,g.HS,l.sg,l.mk,l.RF,l.n9,D.yS],encapsulation:2,changeDetection:0}),t}(),xt=a(98295),vt=a(17238),wt=a(94494);function kt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"#"),k.qZA())}function bt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(3);k.uIk("rowspan",n.expandedTaskLogs.has(i.process)?2:1),k.xp6(1),k.Oqu(i.index+1)}}function Tt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Sub-TaskID"),k.qZA())}function yt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.process)}}function At(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Job ID"),k.qZA())}function qt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.pid)}}function _t(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Task Name"),k.qZA())}function Ct(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.taskName)}}function St(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Start time"),k.qZA())}function Ut(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu((null==i.startTime?null:i.startTime.format("YYYY/MM/DD HH:mm:ss"))||"N/A")}}function Rt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"End time"),k.qZA())}function Nt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu((null==i.endTime?null:i.endTime.format("YYYY/MM/DD HH:mm:ss"))||"N/A")}}function Pt(t,e){1&t&&(k.TgZ(0,"th",33),k._uU(1,"Standard o/e"),k.qZA())}function Jt(t,e){if(1&t){var i=k.EpF();k.ynx(0),k.TgZ(1,"a",34),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().$implicit;return k.oxw(3).openStdoe(t,"stdout")}),k._uU(2,"stdout"),k.qZA(),k._uU(3," | "),k.TgZ(4,"a",34),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().$implicit;return k.oxw(3).openStdoe(t,"stderr")}),k._uU(5,"stderr"),k.qZA(),k.BQk()}}function It(t,e){if(1&t&&(k.TgZ(0,"td",32),k.YNc(1,Jt,6,0,"ng-container",3),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngIf",i.startTime)}}function Qt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Cores"),k.qZA())}function Dt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.cpus)}}function Yt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Memory"),k.qZA())}function jt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.memory)}}function Mt(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Nodes"),k.qZA())}function Lt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.nodes)}}function Ot(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Exit code"),k.qZA())}function Bt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i.exitCode)}}function Ft(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Proxy"),k.qZA())}function $t(t,e){if(1&t){var i=k.EpF();k.ynx(0),k.TgZ(1,"a",34),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().$implicit;return k.oxw(3).openProxyPage(t)}),k._uU(2,"link"),k.qZA(),k.BQk()}}function Et(t,e){1&t&&(k.ynx(0),k.TgZ(1,"small",1),k._uU(2,"N/A"),k.qZA(),k.BQk())}function zt(t,e){if(1&t&&(k.TgZ(0,"td",32),k.YNc(1,$t,3,0,"ng-container",3),k.YNc(2,Et,3,0,"ng-container",3),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngIf",i.proxy&&i.startTime&&!i.endTime&&"null"===i.exitCode),k.xp6(1),k.Q6J("ngIf",!i.proxy)}}function Ht(t,e){1&t&&(k.TgZ(0,"th",31),k._uU(1,"Duration"),k.qZA())}function Vt(t,e){if(1&t&&(k.TgZ(0,"td",32),k._uU(1),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(3);k.xp6(1),k.Oqu(n.timeDurations[i.index])}}function Xt(t,e){if(1&t&&(k.TgZ(0,"td",35),k.TgZ(1,"div",36),k.TgZ(2,"strong"),k._uU(3,"Command"),k.qZA(),k._uU(4,": "),k.TgZ(5,"small",1),k._uU(6),k.qZA(),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(3);k.uIk("colspan",n.expandedTaskLogs.has(i.process)?12:13),k.xp6(1),k.Q6J("@detailExpand",n.expandedTaskLogs.has(i.process)?"expanded":"collapsed"),k.xp6(5),k.Oqu(i.command)}}function Wt(t,e){1&t&&k._UZ(0,"tr",37)}function Kt(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"tr",38),k.NdJ("click",function(){var t=k.CHM(i).$implicit;return k.oxw(3).toggleRows(t.process)}),k.qZA()}if(2&t){var n=e.$implicit,r=k.oxw(3);k.ekj("table-primary",r.expandedTaskLogs.has(n.process))}}function Gt(t,e){if(1&t&&k._UZ(0,"tr",39),2&t){var i=e.$implicit,n=k.oxw(3);k.ekj("table-primary",n.expandedTaskLogs.has(i.process))}}var te=function(){return["taskIndex","process","pid","taskName","stdoe","start","end","cpus","memory","nodes","exitCode","proxy","duration"]},ee=function(){return["command"]};function ie(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",8),k.TgZ(1,"table",9),k.NdJ("matSortChange",function(t){return k.CHM(i),k.oxw(2).sortLogs(t)}),k.ALo(2,"slice"),k.ynx(3,10),k.YNc(4,kt,2,0,"th",11),k.YNc(5,bt,2,2,"td",12),k.BQk(),k.ynx(6,13),k.YNc(7,Tt,2,0,"th",11),k.YNc(8,yt,2,1,"td",12),k.BQk(),k.ynx(9,14),k.YNc(10,At,2,0,"th",11),k.YNc(11,qt,2,1,"td",12),k.BQk(),k.ynx(12,15),k.YNc(13,_t,2,0,"th",11),k.YNc(14,Ct,2,1,"td",12),k.BQk(),k.ynx(15,16),k.YNc(16,St,2,0,"th",11),k.YNc(17,Ut,2,1,"td",12),k.BQk(),k.ynx(18,17),k.YNc(19,Rt,2,0,"th",11),k.YNc(20,Nt,2,1,"td",12),k.BQk(),k.ynx(21,18),k.YNc(22,Pt,2,0,"th",19),k.YNc(23,It,2,1,"td",12),k.BQk(),k.ynx(24,20),k.YNc(25,Qt,2,0,"th",11),k.YNc(26,Dt,2,1,"td",12),k.BQk(),k.ynx(27,21),k.YNc(28,Yt,2,0,"th",11),k.YNc(29,jt,2,1,"td",12),k.BQk(),k.ynx(30,22),k.YNc(31,Mt,2,0,"th",11),k.YNc(32,Lt,2,1,"td",12),k.BQk(),k.ynx(33,23),k.YNc(34,Ot,2,0,"th",11),k.YNc(35,Bt,2,1,"td",12),k.BQk(),k.ynx(36,24),k.YNc(37,Ft,2,0,"th",11),k.YNc(38,zt,3,2,"td",12),k.BQk(),k.ynx(39,25),k.YNc(40,Ht,2,0,"th",11),k.YNc(41,Vt,2,1,"td",12),k.BQk(),k.ynx(42,26),k.YNc(43,Xt,7,3,"td",27),k.BQk(),k.YNc(44,Wt,1,0,"tr",28),k.YNc(45,Kt,1,2,"tr",29),k.YNc(46,Gt,1,2,"tr",30),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(2);k.xp6(1),k.Q6J("dataSource",k.Dn7(2,4,n._taskLogs,n.pageIndex*n.pageSize,(n.pageIndex+1)*n.pageSize)),k.xp6(43),k.Q6J("matHeaderRowDef",k.DdM(8,te)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(9,te)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(10,ee))}}var ne=function(){return[5,10,25,50,100,500]};function re(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div"),k.TgZ(1,"mat-button-toggle-group",4),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw().filterType=t})("ngModelChange",function(){return k.CHM(i),k.oxw().updateFilter()}),k.TgZ(2,"mat-button-toggle",5),k._uU(3,"All"),k.qZA(),k.TgZ(4,"mat-button-toggle",5),k._uU(5,"Running"),k.qZA(),k.TgZ(6,"mat-button-toggle",5),k._uU(7,"Failed"),k.qZA(),k.TgZ(8,"mat-button-toggle",5),k._uU(9,"Finished"),k.qZA(),k.qZA(),k.TgZ(10,"mat-paginator",6),k.NdJ("page",function(t){return k.CHM(i),k.oxw().onPageChange(t)}),k.qZA(),k.YNc(11,ie,47,11,"div",7),k.TgZ(12,"mat-paginator",6),k.NdJ("page",function(t){return k.CHM(i),k.oxw().onPageChange(t)}),k.qZA(),k.qZA()}if(2&t){var n=k.oxw();k.xp6(1),k.Q6J("ngModel",n.filterType),k.xp6(1),k.Q6J("value","all"),k.xp6(2),k.Q6J("value","running"),k.xp6(2),k.Q6J("value","failed"),k.xp6(2),k.Q6J("value","finished"),k.xp6(2),k.Q6J("length",null==n.taskLogs?null:n.taskLogs.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",k.DdM(14,ne)),k.xp6(1),k.Q6J("ngIf","table"===n.mode),k.xp6(1),k.Q6J("length",null==n.taskLogs?null:n.taskLogs.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",k.DdM(15,ne))}}var ae=function(){var t=function(){function t(e){s(this,t),this.dialog=e,this.taskLogs=[],this.mode="table",this.expandedTaskLogs=new Set,this.fullTaskLogs=["process","pid","taskName","stdoe","start","end","cpus","memory","nodes","exitCode","proxy"],this.prepareTaskLogs=["process","taskName","exec","args","cpus","memory","nodes"],this.displayColumns=[],this.displayRows=[],this.pageSize=30,this.pageIndex=0,this.progressFinished=0,this.progressRunning=0,this.taskFinishedNumber=0,this.taskRunningNumber=0,this.taskNotStartedNumber=0,this.progressMode="indeterminate",this.timeDurations=[],this.timer$=(0,O.F)(3e3),this.sortField="index",this.sortDirection="asc",this.filterType="all"}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.timerSubscriber=this.timer$.subscribe(function(){t.taskLogs&&(t.taskLogs.forEach(function(e,i){(!t.timeDurations[i]||"null"===e.exitCode&&e.startTime&&"null"!==e.startTime.toString()&&(!e.endTime||"null"===e.endTime.toString()))&&(t.timeDurations[i]=t.taskDuration(e))}),t.taskLogTable&&t.taskLogTable.renderRows&&t.taskLogTable.renderRows())}),momentDurationFormatSetup(M)}},{key:"ngOnChanges",value:function(t){var e=this;t.mode&&(this.mode=t.mode.currentValue);if(t.taskLogs){var i=t.taskLogs.currentValue;t.taskLogs.isFirstChange(),i?i[0]&&i[0].isFull?(this.displayColumns=this.fullTaskLogs,this.progressMode="buffer",this.taskFinishedNumber=i.filter(function(t){return null!=t.exitCode&&t.startTime&&"null"!==t.startTime.toString()&&(!t.endTime||"null"!==t.endTime.toString())}).length,this.taskRunningNumber=i.filter(function(t){return null==t.exitCode&&t.startTime&&"null"!==t.startTime.toString()&&(!t.endTime||"null"===t.endTime.toString())}).length,this.progressFinished=this.taskFinishedNumber/i.length*100,this.progressRunning=this.progressFinished+this.taskRunningNumber/i.length*100,this.timeDurations=this.taskLogs.map(function(t){return e.taskDuration(t)})):(this.displayColumns=this.prepareTaskLogs,this.progressMode="indeterminate"):(this.displayColumns=[],this.progressMode="indeterminate")}"graph"===this.mode&&this.taskLogs||"table"===this.mode&&this.taskLogs&&this.taskLogTable&&this.taskLogTable.renderRows&&this.taskLogTable.renderRows()}},{key:"taskDuration",value:function(t){var e=t.startTime,i=t.endTime;if(!e)return"N/A";e=M(e),i=i?M(i):M();var n=M(i).diff(e);return M.duration(n).format("hh:mm:ss",{trim:!1})}},{key:"onPageChange",value:function(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize}},{key:"toggleRows",value:function(t){this.expandedTaskLogs.has(t)?this.expandedTaskLogs.delete(t):this.expandedTaskLogs.add(t)}},{key:"_taskLogs",get:function(){var t=this;if(Array.isArray(this.taskLogs)){var e=[];switch(this.filterType){case"running":e=this.taskLogs.filter(function(t){return t.startTime&&!t.endTime});break;case"failed":e=this.taskLogs.filter(function(t){return t.startTime&&t.endTime&&"0"!==t.exitCode});break;case"finished":e=this.taskLogs.filter(function(t){return t.startTime&&t.endTime&&"0"===t.exitCode});break;default:e=this.taskLogs.slice()}var i=this.sortField||"index";this.sortDirection=this.sortDirection||"asc";var n="desc"===this.sortDirection?-1:1;return"start"===i?e.sort(function(t,e){return M(t.startTime).isBefore(e.startTime)?-1*n:1*n}):"end"===i?e.sort(function(t,e){return M(t.endTime).isBefore(e.endTime)?-1*n:1*n}):e="duration"===i?(0,wt.X)(e,[function(e){return t.timeDurations[e.index]},function(t){return t.index}],[this.sortDirection,"asc"]):(0,wt.X)(e,[function(t){return t[i]}],this.sortDirection),e}return[]}},{key:"updateFilter",value:function(){return this.taskLogTable&&this.taskLogTable.renderRows()}},{key:"openProxyPage",value:function(t){window&&window.open("/page?result=".concat(this.resultID,"&fullpage=true&proxy=true&pageKey=").concat(t.process),"","width=1024,height=768")}},{key:"openStdoe",value:function(t,e){!window||["stdout","stderr"].indexOf(e)<0||window.open("/result/api/".concat(this.resultID,"/taskLog?jobID=").concat(t.process,"&stdoe=").concat(e),"","width=1024,height=768")}},{key:"sortLogs",value:function(t){return t.direction?(this.sortField="taskIndex"===t.active?"index":t.active,this.sortDirection=t.direction):(this.sortField="index",this.sortDirection="asc"),this.taskLogTable&&this.taskLogTable.renderRows()}},{key:"ngOnDestroy",value:function(){return this.timerSubscriber&&this.timerSubscriber.unsubscribe()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.Y36(V.uw))},t.\u0275cmp=k.Xpm({type:t,selectors:[["chi-tasklog-viewer"]],viewQuery:function(t,e){var i;(1&t&&k.Gf(m.BZ,5),2&t)&&(k.iGM(i=k.CRH())&&(e.taskLogTable=i.first))},inputs:{taskLogs:"taskLogs",resultID:"resultID",mode:"mode"},features:[k.TTD],decls:5,vars:6,consts:[[2,"width","100%","overflow-x","auto"],[1,"text-muted"],[3,"mode","value","bufferValue"],[4,"ngIf"],[3,"ngModel","ngModelChange"],[3,"value"],[3,"length","pageSize","pageIndex","pageSizeOptions","page"],["class","table-responsive",4,"ngIf"],[1,"table-responsive"],["mat-table","","multiTemplateDataRows","","matSort","",1,"table","table-bordered","table-hover",3,"dataSource","matSortChange"],["matColumnDef","taskIndex"],["mat-header-cell","","mat-sort-header","","class","align-middle text-center",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-center",4,"matCellDef"],["matColumnDef","process"],["matColumnDef","pid"],["matColumnDef","taskName"],["matColumnDef","start"],["matColumnDef","end"],["matColumnDef","stdoe"],["mat-header-cell","","class","align-middle text-center",4,"matHeaderCellDef"],["matColumnDef","cpus"],["matColumnDef","memory"],["matColumnDef","nodes"],["matColumnDef","exitCode"],["matColumnDef","proxy"],["matColumnDef","duration"],["matColumnDef","command"],["mat-cell","","style","background-color: rgba(122, 168, 255, 0.1);","class","px-3",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","link",3,"table-primary","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","command-detail-row",3,"table-primary",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",1,"align-middle","text-center"],["mat-cell","",1,"align-middle","text-center"],["mat-header-cell","",1,"align-middle","text-center"],[3,"click"],["mat-cell","",1,"px-3",2,"background-color","rgba(122, 168, 255, 0.1)"],[1,"command-details","my-3"],["mat-header-row",""],["mat-row","",1,"link",3,"click"],["mat-row","",1,"command-detail-row"]],template:function(t,e){1&t&&(k.TgZ(0,"div",0),k.TgZ(1,"small",1),k._uU(2),k.qZA(),k._UZ(3,"mat-progress-bar",2),k.YNc(4,re,13,16,"div",3),k.qZA()),2&t&&(k.xp6(2),k.AsE("Progress: ",e.taskFinishedNumber,"/",null==e.taskLogs?null:e.taskLogs.length,""),k.xp6(1),k.Q6J("mode",e.progressMode)("value",e.progressFinished)("bufferValue",e.progressRunning),k.xp6(1),k.Q6J("ngIf",e.taskLogs))},directives:[N,l.O5,d.A9,u.JJ,u.On,d.Yi,w.NW,m.BZ,Z.YE,m.w1,m.fO,m.Dz,m.as,m.nj,m.ge,Z.nU,m.ev,m.XQ,m.Gk],pipes:[l.OU],styles:[".command-details[_ngcontent-%COMP%]{overflow:hidden;display:none}tr.command-detail-row[_ngcontent-%COMP%]{height:0;width:100%}[_nghost-%COMP%]     .mat-sort-header-container{display:flex;justify-content:center}"],data:{animation:[(0,vt.X$)("detailExpand",[(0,vt.SB)("collapsed",(0,vt.oB)({height:"0px",padding:"0px",minHeight:"0",display:"none"})),(0,vt.SB)("expanded",(0,vt.oB)({height:"*",padding:"5px",display:"block"})),(0,vt.eR)("expanded <=> collapsed",(0,vt.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t}(),se=a(96995),oe=a(9919),le=["workflowProgressDisplay"];function ue(t,e){1&t&&(k.TgZ(0,"span",15),k._UZ(1,"i",16),k.qZA())}function ce(t,e){1&t&&(k.TgZ(0,"span",17),k._UZ(1,"i",18),k.qZA())}function de(t,e){1&t&&(k.TgZ(0,"span",19),k._UZ(1,"i",20),k.qZA())}function ge(t,e){1&t&&(k.TgZ(0,"span",21),k._UZ(1,"i",22),k.qZA())}function fe(t,e){1&t&&(k.TgZ(0,"span",23),k._UZ(1,"i",24),k.qZA())}function pe(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",6),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().index,e=k.oxw().index,n=k.oxw();return n.showStep(e*n.displayStepsInARow+t)}),k.TgZ(1,"div",7),k.TgZ(2,"span",8),k.YNc(3,ue,2,0,"span",9),k.YNc(4,ce,2,0,"span",10),k.YNc(5,de,2,0,"span",11),k.YNc(6,ge,2,0,"span",12),k.YNc(7,fe,2,0,"span",13),k.qZA(),k.TgZ(8,"span",14),k._uU(9),k.qZA(),k._uU(10),k.qZA(),k.qZA()}if(2&t){var n=k.oxw().index,r=k.oxw().index,a=k.oxw();k.Udp("width",96/a.displayStepsInARow+"%"),k.ekj("success",2==a.childResultStatus[r*a.displayStepsInARow+n])("error",3==a.childResultStatus[r*a.displayStepsInARow+n])("processing",1==a.childResultStatus[r*a.displayStepsInARow+n])("active",null!=a.displayStep&&a.displayStep==r*a.displayStepsInARow+n)("blur",null!=a.displayStep&&a.displayStep!=r*a.displayStepsInARow+n),k.xp6(1),k.Udp("width","100%")("margin-left",0==n?"5px":"0px"),k.xp6(1),k.Q6J("ngSwitch",a.childResultStatus[r*a.displayStepsInARow+n]),k.xp6(1),k.Q6J("ngSwitchCase",0),k.xp6(1),k.Q6J("ngSwitchCase",1),k.xp6(1),k.Q6J("ngSwitchCase",2),k.xp6(1),k.Q6J("ngSwitchCase",3),k.xp6(1),k.Q6J("ngSwitchCase",4),k.xp6(2),k.hij(" ",r*a.displayStepsInARow+n+1,". "),k.xp6(1),k.hij(" ",a.getStepName(r*a.displayStepsInARow+n)," ")}}function he(t,e){if(1&t&&(k.ynx(0),k.YNc(1,pe,11,24,"div",5),k.BQk()),2&t){var i=e.index,n=k.oxw().index,r=k.oxw();k.xp6(1),k.Q6J("ngIf",(r.displayStep===n*r.displayStepsInARow+i||void 0===r.displayStep)&&r.isMinimal||!r.isMinimal)}}function me(t,e){if(1&t&&(k.TgZ(0,"div",3),k.YNc(1,he,2,1,"ng-container",4),k.qZA()),2&t){var i=e.$implicit,n=k.oxw();k.Udp("width",n.displayWidth+"px"),k.xp6(1),k.Q6J("ngForOf",i)}}var Ze=function(){var t=function(){function t(){s(this,t),this.stepSelect=new k.vpe,this.displayStepsInARow=5,this.childResultStatus=[],this.childResults=[],this.stepDisplay=[],this.displayWidth=0,this.isMinimal=!1}return e(t,[{key:"ngOnChanges",value:function(t){var e=this;for(var i in t)"currentResult"===i?this.currentResult=t[i].currentValue:"currentProject"===i?this.currentProject=t[i].currentValue:"taskID2Task"===i&&(this.taskID2Task=t[i].currentValue);this.currentProject&&this.currentResult&&setTimeout(function(){e.settingStepsInARow()},300)}},{key:"settingStepsInARow",value:function(){if(this.resultInfoEl){var t=this.resultInfoEl.nativeElement.offsetWidth;this.isMinimal=!1,t>=1400?this.displayStepsInARow=7:t>=1024?this.displayStepsInARow=5:t>=480?this.displayStepsInARow=3:(this.displayStepsInARow=1,this.isMinimal=!0),this.displayWidth!==.99*t&&(this.displayWidth=.99*t,this.childResults=this.getChildResults(),this.checkChildResultStatus(),this.stepDisplay=this.displaySteps())}}},{key:"onResize",value:function(t){var e=this;!1!==this.onResizeTimer&&clearTimeout(this.onResizeTimer),this.displayWidth=0,this.onResizeTimer=setTimeout(function(){e.settingStepsInARow()},800)}},{key:"getChildResults",value:function(){var t=[[]];if(this.currentProject&&this.currentResult)for(var e=this.currentProject.results,i=0;i<this.currentResult.children.length;i++){var n=this.currentResult.children[i];t[i]=[];for(var r=0;r<n.length;r++)for(var a=0;a<e.length;a++)e[a].id===n[r]&&(t[i][r]=e[a])}return t}},{key:"showStep",value:function(t){this.displayStep=this.displayStep===t?void 0:t,this.stepSelect.emit(this.displayStep)}},{key:"displaySteps",value:function(){for(var t=this.displayStepsInARow,e=Math.ceil(this.childResults.length/t),i=[],n=0;n<e;n++)i[n]=this.childResults.slice(n*t,(n+1)*t);return i}},{key:"checkChildResultStatus",value:function(){this.childResultStatus=[];for(var t=0;t<this.childResults.length;t++){var e=this.childResults[t];if(Array.isArray(e)&&e.length>0){this.childResultStatus[t]=2;for(var i=0;i<e.length;i++)switch(e[i].status){case 0:this.childResultStatus[t]=0;break;case 1:this.childResultStatus[t]=this.childResultStatus[t]>1?1:this.childResultStatus[t];break;case 3:this.childResultStatus[t]=3}}else this.childResultStatus[t]=-1}}},{key:"getStepName",value:function(t){var e,i=this,n="";if(!this.currentResult)return n;if(this.currentResult.task&&this.currentResult.task.id?e=this.currentResult.task:this.currentResult.taskSnapshot&&this.currentResult.taskSnapshot.id&&(e=this.currentResult.taskSnapshot),e){if(Array.isArray(e.stepNames)&&(n=e.stepNames[t]))return n;if(e.mapper){var r=e.mapper[t];n=r?r.map(function(t){return t.id&&i.taskID2Task&&i.taskID2Task[t.id]?i.taskID2Task[t.id].name:""}).join(", "):"N/A"}else this.childResults[t]&&(n=this.childResults[t].map(function(t){return t.name}).join(", "))}return n}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=k.Xpm({type:t,selectors:[["workflow-progress-display"]],viewQuery:function(t,e){var i;(1&t&&k.Gf(le,7),2&t)&&(k.iGM(i=k.CRH())&&(e.resultInfoEl=i.first))},inputs:{currentResult:"currentResult",currentProject:"currentProject",displayStep:"displayStep",taskID2Task:"taskID2Task"},outputs:{stepSelect:"stepSelect"},features:[k.TTD],decls:3,vars:1,consts:[[2,"width","100%","padding-left","1%",3,"resize"],["workflowProgressDisplay",""],["class","wrap",3,"width",4,"ngFor","ngForOf"],[1,"wrap"],[4,"ngFor","ngForOf"],["class","workflowProgress",3,"width","success","error","processing","active","blur","click",4,"ngIf"],[1,"workflowProgress",3,"click"],[2,"padding","0 20px","overflow","hidden","text-overflow","ellipsis"],[3,"ngSwitch"],["class","text-info",4,"ngSwitchCase"],["class","text-primary",4,"ngSwitchCase"],["class","text-success",4,"ngSwitchCase"],["class","text-danger",4,"ngSwitchCase"],["class","text-warning",4,"ngSwitchCase"],[1,"text-muted"],[1,"text-info"],["aria-hidden","true",1,"fas","fa-hourglass-half","fa-fw"],[1,"text-primary"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin","fa-fw"],[1,"text-success"],["aria-hidden","true",1,"fas","fa-check","fa-fw"],[1,"text-danger"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],[1,"text-warning"],["aria-hidden","true",1,"fas","fa-trash","fa-fw"]],template:function(t,e){1&t&&(k.TgZ(0,"div",0,1),k.NdJ("resize",function(t){return e.onResize(t)},!1,k.Jf7),k.YNc(2,me,2,3,"div",2),k.qZA()),2&t&&(k.xp6(2),k.Q6J("ngForOf",e.stepDisplay))},directives:[l.sg,l.O5,l.RF,l.n9],styles:['.wrap[_ngcontent-%COMP%]{width:100%;white-space:nowrap;overflow:hidden;transform-style:preserve-3d;perspective:1600px}.wrap[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-left:-1%}.workflowProgress[_ngcontent-%COMP%]{margin:0 0 0 .5%;height:30px;position:relative;display:inline-block;text-align:left;line-height:30px;transition:all .8s;cursor:pointer}.workflowProgress[_ngcontent-%COMP%]:before, .workflowProgress[_ngcontent-%COMP%]:after{content:"";position:absolute;transition:all .8s;z-index:-1}.workflowProgress[_ngcontent-%COMP%]:before{height:15px;width:100%;top:0;left:0;background:lightgray;transform:skew(45deg)}.workflowProgress[_ngcontent-%COMP%]:after{height:15px;width:100%;top:14px;left:0;background:lightgray;transform:skew(-45deg)}.workflowProgress.success[_ngcontent-%COMP%]:before, .workflowProgress.success[_ngcontent-%COMP%]:after{background:lightgreen}.workflowProgress.error[_ngcontent-%COMP%]:before, .workflowProgress.error[_ngcontent-%COMP%]:after{background:lightcoral}.workflowProgress.processing[_ngcontent-%COMP%]:before, .workflowProgress.processing[_ngcontent-%COMP%]:after{background:sandybrown}.workflowProgress.active[_ngcontent-%COMP%]:before, .workflowProgress.active[_ngcontent-%COMP%]:after{transition:all .3s cubic-bezier(.25,.8,.25,1)}.workflowProgress.blur[_ngcontent-%COMP%]:before, .workflowProgress.blur[_ngcontent-%COMP%]:after{opacity:.3}']}),t}(),xe=a(4696),ve=["resultInfoContainer"];function we(t,e){1&t&&(k.TgZ(0,"a"),k._uU(1,"Project"),k.qZA())}function ke(t,e){if(1&t&&(k.TgZ(0,"span"),k._uU(1),k.qZA()),2&t){var i=k.oxw(2);k.xp6(1),k.hij(": ",i.currentProject.name,"")}}var be=function(t){return["/project",t]};function Te(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"a",14),k.NdJ("click",function(){return k.CHM(i),k.oxw().gotoProject()}),k._uU(1,"Project "),k.YNc(2,ke,2,1,"span",3),k.qZA()}if(2&t){var n=k.oxw();k.Q6J("routerLink",k.VKq(2,be,n.currentProject.id)),k.xp6(2),k.Q6J("ngIf",n.currentProject)}}function ye(t,e){1&t&&(k.TgZ(0,"li",1),k._uU(1,"Project"),k.qZA())}var Ae=function(t){return["/project",t,"result","list"]};function qe(t,e){if(1&t&&(k.TgZ(0,"a",2),k._uU(1," Result List "),k.qZA()),2&t){var i=k.oxw();k.Q6J("routerLink",k.VKq(1,Ae,i.currentProject.id))}}var _e=function(t){return["/result",t,"info"]};function Ce(t,e){if(1&t&&(k.TgZ(0,"li",15),k.TgZ(1,"a",2),k._uU(2,"Result"),k.qZA(),k.TgZ(3,"a",16),k._UZ(4,"i",17),k.qZA(),k.qZA()),2&t){var i=k.oxw();k.xp6(1),k.Q6J("routerLink",k.VKq(2,_e,i.result.id)),k.xp6(2),k.Q6J("routerLink",k.VKq(4,_e,i.result.id))}}function Se(t,e){1&t&&(k.TgZ(0,"li",15),k._uU(1,"Result"),k.qZA())}function Ue(t,e){1&t&&(k.TgZ(0,"div"),k._uU(1," Loading... "),k.qZA())}function Re(t,e){if(1&t&&(k.TgZ(0,"p"),k.TgZ(1,"u",36),k._uU(2),k.qZA(),k._uU(3),k.TgZ(4,"u",36),k._uU(5),k.qZA(),k.qZA()),2&t){var i=k.oxw(2);k.xp6(2),k.Oqu(null==i.result?null:i.result.prefix),k.xp6(1),k.Oqu(null==i.result?null:i.result.name),k.xp6(2),k.Oqu(null==i.result?null:i.result.suffix)}}function Ne(t,e){if(1&t){var i=k.EpF();k.ynx(0),k.TgZ(1,"mat-form-field",37),k.TgZ(2,"input",38),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(2).result.prefix=t}),k.qZA(),k.qZA(),k.TgZ(3,"mat-form-field",37),k.TgZ(4,"input",39),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(2).result.suffix=t}),k.qZA(),k.qZA(),k.TgZ(5,"mat-form-field",40),k.TgZ(6,"input",41),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(2).result.name=t}),k.qZA(),k.TgZ(7,"span",42),k._UZ(8,"u",43),k.qZA(),k.TgZ(9,"span",44),k._UZ(10,"u",43),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw(2);k.xp6(2),k.Q6J("ngModel",n.result.prefix),k.xp6(2),k.Q6J("ngModel",n.result.suffix),k.xp6(2),k.Q6J("ngModel",n.result.name),k.xp6(2),k.Q6J("innerHTML",null==n.result?null:n.result.prefix,k.oJD),k.xp6(2),k.Q6J("innerHTML",null==n.result?null:n.result.suffix,k.oJD)}}function Pe(t,e){1&t&&(k.TgZ(0,"p"),k._uU(1,"(no description)"),k.qZA())}function Je(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"mat-form-field",40),k.TgZ(1,"textarea",45),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(2).result.desc=t}),k._uU(2),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(2);k.xp6(1),k.Q6J("ngModel",n.result.desc),k.xp6(1),k.Oqu(n.result.desc)}}var Ie=function(){return["/admin","task"]},Qe=function(t){return{pkgs:t}};function De(t,e){if(1&t&&(k.TgZ(0,"a",47),k._UZ(1,"i",48),k.qZA()),2&t){var i=k.oxw(3);k.Q6J("routerLink",k.DdM(2,Ie))("queryParams",k.VKq(3,Qe,i.currentPackage.id))}}function Ye(t,e){if(1&t&&(k.TgZ(0,"div",18),k.TgZ(1,"div",19),k.TgZ(2,"b"),k._uU(3,"Package name"),k.qZA(),k.qZA(),k.TgZ(4,"div",20),k.TgZ(5,"p"),k._UZ(6,"i",46),k._uU(7),k.YNc(8,De,2,5,"a",24),k.qZA(),k.qZA(),k.qZA()),2&t){var i=k.oxw(2);k.xp6(7),k.hij("",null==i.currentPackage?null:i.currentPackage.fullname," "),k.xp6(1),k.Q6J("ngIf",null==i.currentPackage||null==i.currentPackage.privilege?null:i.currentPackage.privilege.canView)}}var je=function(t,e){return{pkgs:t,tasks:e}};function Me(t,e){if(1&t&&(k.TgZ(0,"a",47),k._UZ(1,"i",48),k.qZA()),2&t){var i=k.oxw(2);k.Q6J("routerLink",k.DdM(2,Ie))("queryParams",k.WLB(3,je,i.currentPackage.id,null==i.result||null==i.result.task?null:i.result.task.id))}}function Le(t,e){1&t&&(k.TgZ(0,"p",49),k._UZ(1,"i",50),k._uU(2,"Queued"),k.qZA())}function Oe(t,e){1&t&&(k.TgZ(0,"p",51),k._UZ(1,"i",52),k._uU(2,"Running"),k.qZA())}function Be(t,e){1&t&&(k.TgZ(0,"p",53),k._UZ(1,"i",54),k._uU(2,"Success"),k.qZA())}function Fe(t,e){1&t&&(k.TgZ(0,"p",55),k._UZ(1,"i",56),k._uU(2,"Error"),k.qZA())}function $e(t,e){1&t&&(k.TgZ(0,"p",57),k._UZ(1,"i",58),k._uU(2,"Deleting"),k.qZA())}function Ee(t,e){if(1&t&&(k.TgZ(0,"div",18),k.TgZ(1,"div",19),k.TgZ(2,"b"),k._uU(3,"Finished time"),k.qZA(),k.qZA(),k.TgZ(4,"div",20),k.TgZ(5,"p"),k._uU(6),k.qZA(),k.qZA(),k.qZA()),2&t){var i=k.oxw(2);k.xp6(6),k.Oqu(i.result.timer&&i.result.timer[2]?i.result.timer[2].toString():null!=i.result&&i.result.timer&&i.result.timer[1]?i.result.timer[1].toString():"")}}var ze=function(){return["/page"]},He=function(t,e){return{result:t,pageKey:e}};function Ve(t,e){if(1&t&&(k.TgZ(0,"a",69),k._UZ(1,"i",70),k._uU(2),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(2).$implicit,r=k.oxw(3);k.Q6J("routerLink",k.DdM(3,ze))("queryParams",k.WLB(4,He,r.result.id,n.id+":"+i.key)),k.xp6(2),k.hij(" ",i.name," ")}}function Xe(t,e){if(1&t&&(k.ynx(0),k.TgZ(1,"div",61),k.TgZ(2,"h4",62),k.TgZ(3,"div",63),k._UZ(4,"i",64),k._uU(5),k.qZA(),k.TgZ(6,"div",65),k._UZ(7,"i",66),k._uU(8),k.qZA(),k.qZA(),k.qZA(),k.TgZ(9,"div",67),k.YNc(10,Ve,3,7,"a",68),k.qZA(),k.BQk()),2&t){var i=k.oxw().$implicit,n=k.oxw(3);k.xp6(5),k.hij(" ",i.fullname,","),k.xp6(3),k.hij(" ",i.sheetName,""),k.xp6(2),k.Q6J("ngForOf",i.getValidResultPages((null==n.result.task?null:n.result.task.key)||(null==n.result.taskSnapshot?null:n.result.taskSnapshot.key)||""))}}function We(t,e){if(1&t&&(k.ynx(0),k.YNc(1,Xe,11,3,"ng-container",3),k.BQk()),2&t){var i=e.$implicit,n=k.oxw(3);k.xp6(1),k.Q6J("ngIf",i.getValidResultPages((null==n.result.task?null:n.result.task.key)||(null==n.result.taskSnapshot?null:n.result.taskSnapshot.key)||"").length>0)}}function Ke(t,e){if(1&t&&(k.TgZ(0,"div",59),k.TgZ(1,"div",34),k.TgZ(2,"p"),k.TgZ(3,"b"),k._uU(4,"Available Result Pages"),k.qZA(),k.qZA(),k.qZA(),k.YNc(5,We,2,1,"ng-container",60),k.qZA()),2&t){var i=k.oxw(2);k.xp6(5),k.Q6J("ngForOf",i.currentProject.packages)}}function Ge(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"span"),k._uU(1,"Currently, no available proxy pages. "),k.TgZ(2,"a",75),k.NdJ("click",function(){return k.CHM(i),k.oxw(4).getProxyPages()}),k._UZ(3,"i",72),k.qZA(),k.qZA()}}var ti=function(t,e){return{result:t,pageKey:e,proxy:!0}};function ei(t,e){if(1&t&&(k.TgZ(0,"a",76),k._UZ(1,"i",77),k._uU(2),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(4);k.Q6J("routerLink",k.DdM(3,ze))("queryParams",k.WLB(4,ti,n.result.id,i)),k.xp6(2),k.hij(" ",i," ")}}function ii(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",59),k.TgZ(1,"div",34),k.TgZ(2,"p"),k.TgZ(3,"b"),k._uU(4,"Available Proxy Pages"),k.qZA(),k.TgZ(5,"button",71),k.NdJ("click",function(){return k.CHM(i),k.oxw(3).getProxyPages()}),k._UZ(6,"i",72),k.qZA(),k.qZA(),k.qZA(),k.TgZ(7,"div",73),k.YNc(8,Ge,4,0,"span",3),k.YNc(9,ei,3,7,"a",74),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(3);k.xp6(8),k.Q6J("ngIf",0===n.validProxyJobIds.length),k.xp6(1),k.Q6J("ngForOf",n.validProxyJobIds)}}function ni(t,e){if(1&t&&(k.ynx(0),k.YNc(1,ii,10,2,"div",32),k._UZ(2,"mat-divider"),k.BQk()),2&t){var i=k.oxw(2);k.xp6(1),k.Q6J("ngIf",i.currentProject&&i.result.task.proxy)}}function ri(t,e){if(1&t&&(k.TgZ(0,"li",92),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(i)}}function ai(t,e){if(1&t&&(k.TgZ(0,"div",34),k.TgZ(1,"ul",90),k.YNc(2,ri,2,1,"li",91),k.qZA(),k.qZA()),2&t){var i=k.oxw(3);k.xp6(2),k.Q6J("ngForOf",i.result.error.notes)}}function si(t,e){if(1&t&&k._UZ(0,"chi-terminal",93),2&t){var i=k.oxw(3);k.Q6J("text",null==i.result?null:i.result.stdOut)}}function oi(t,e){if(1&t&&k._UZ(0,"chi-terminal",93),2&t){var i=k.oxw(3);k.Q6J("text",null==i.result?null:i.result.stdErr)}}function li(t,e){1&t&&(k.TgZ(0,"div"),k._uU(1,"Task logs"),k.qZA())}function ui(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",59),k.TgZ(1,"div",34),k.TgZ(2,"b"),k._uU(3,"Result Logs"),k.qZA(),k.qZA(),k.YNc(4,ai,3,1,"div",78),k.TgZ(5,"div",34),k.TgZ(6,"mat-tab-group",79),k.NdJ("selectedTabChange",function(t){k.CHM(i);var e=k.oxw(2);return e.onResultTabChange(t,e.result.id)}),k.TgZ(7,"mat-tab",80),k.TgZ(8,"div",81),k.YNc(9,si,1,1,"chi-terminal",82),k.qZA(),k.qZA(),k.TgZ(10,"mat-tab",83),k.TgZ(11,"div",81),k.YNc(12,oi,1,1,"chi-terminal",82),k.qZA(),k.qZA(),k.TgZ(13,"mat-tab"),k.YNc(14,li,2,0,"ng-template",84),k.TgZ(15,"div",81),k.TgZ(16,"button",85),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2);return t.loadResultLogs(t.result.id)}),k._UZ(17,"i",86),k._uU(18,"Refresh logs "),k.qZA(),k.TgZ(19,"mat-button-toggle-group",87),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(2).taskLogViewMode=t}),k.TgZ(20,"mat-button-toggle",88),k._uU(21,"Table View"),k.qZA(),k.qZA(),k._UZ(22,"chi-tasklog-viewer",89),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(2);k.xp6(4),k.Q6J("ngIf",n.result.error&&n.result.error.notes),k.xp6(5),k.Q6J("ngIf",n.result),k.xp6(3),k.Q6J("ngIf",n.result),k.xp6(7),k.Q6J("ngModel",n.taskLogViewMode),k.xp6(3),k.Q6J("mode",n.taskLogViewMode)("taskLogs",n.resultTaskLogs[n.result.id])("resultID",n.result.id)}}function ci(t,e){if(1&t&&(k.TgZ(0,"div",34),k.TgZ(1,"div",90),k._UZ(2,"i",96),k._uU(3),k.qZA(),k.qZA()),2&t){var i=k.oxw(3);k.xp6(3),k.hij("",i.result.stdErr," ")}}function di(t,e){if(1&t&&k._UZ(0,"bdp-workflow-planner",97),2&t){var i=k.oxw(3);k.Q6J("taskMapper",i.result.task.mapper)("childTasks",i.taskList)("taskArgs",i.result.task.arguments)("resultList",i.childResults)}}function gi(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"workflow-progress-display",99),k.NdJ("stepSelect",function(t){return k.CHM(i),k.oxw(4).showStep(t)}),k.qZA()}if(2&t){var n=k.oxw(4);k.Q6J("currentProject",n.currentProject)("currentResult",n.result)("taskID2Task",n.taskID2Task)}}function fi(t,e){if(1&t&&(k.TgZ(0,"div",34),k.YNc(1,gi,1,3,"workflow-progress-display",98),k.qZA()),2&t){var i=k.oxw(3);k.xp6(1),k.Q6J("ngIf",i.currentProject&&i.result)}}function pi(t,e){1&t&&(k.TgZ(0,"span",49),k._UZ(1,"i",50),k.qZA())}function hi(t,e){1&t&&(k.TgZ(0,"span",51),k._UZ(1,"i",52),k.qZA())}function mi(t,e){1&t&&(k.TgZ(0,"span",53),k._UZ(1,"i",54),k.qZA())}function Zi(t,e){1&t&&(k.TgZ(0,"span",55),k._UZ(1,"i",56),k.qZA())}function xi(t,e){1&t&&(k.TgZ(0,"span",57),k._UZ(1,"i",116),k.qZA())}function vi(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",114),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2),e=t.$implicit,n=t.index;return k.oxw(4).loadResultInfo(e.id,n)}),k.TgZ(1,"span",115),k.YNc(2,pi,2,0,"span",27),k.YNc(3,hi,2,0,"span",28),k.YNc(4,mi,2,0,"span",29),k.YNc(5,Zi,2,0,"span",30),k.YNc(6,xi,2,0,"span",31),k.qZA(),k._uU(7),k.qZA()}if(2&t){var n=k.oxw(2).$implicit;k.xp6(1),k.Q6J("ngSwitch",n&&n.status),k.xp6(1),k.Q6J("ngSwitchCase",0),k.xp6(1),k.Q6J("ngSwitchCase",1),k.xp6(1),k.Q6J("ngSwitchCase",2),k.xp6(1),k.Q6J("ngSwitchCase",3),k.xp6(1),k.Q6J("ngSwitchCase",4),k.xp6(1),k.hij(" ",n.name," ")}}function wi(t,e){if(1&t&&k._UZ(0,"div",105),2&t){var i=k.oxw(2).$implicit,n=k.oxw(4);k.Q6J("innerHTML",n.resultTimers[i.id].timerDisplay,k.oJD)}}function ki(t,e){if(1&t&&(k.TgZ(0,"div",18),k.TgZ(1,"div",103),k.TgZ(2,"b"),k._uU(3,"Finished time"),k.qZA(),k.qZA(),k.TgZ(4,"div",104),k.TgZ(5,"p"),k._uU(6),k.qZA(),k.qZA(),k.qZA()),2&t){var i=k.oxw(2).$implicit;k.xp6(6),k.Oqu(null!=i&&i.timer&&i.timer.length>=3?i.timer[2].toString():"n/a")}}function bi(t,e){1&t&&(k.TgZ(0,"div"),k._uU(1,"Task logs"),k.qZA())}function Ti(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"button",120),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(3),e=t.$implicit,n=t.index;return k.oxw(4).loadResultInfo(e.id,n)}),k._uU(1,"Load intermediate output file(s)"),k.qZA()}}function yi(t,e){1&t&&(k.TgZ(0,"div",110),k.TgZ(1,"b"),k._uU(2,"Intermediate output file(s)"),k.qZA(),k.qZA())}function Ai(t,e){1&t&&k._UZ(0,"datafile-card",122),2&t&&k.Q6J("dataFile",e.$implicit)}function qi(t,e){if(1&t&&(k.TgZ(0,"div",110),k.TgZ(1,"div",18),k.YNc(2,Ai,1,1,"datafile-card",121),k.qZA(),k.qZA()),2&t){var i=k.oxw(3).$implicit,n=k.oxw(4);k.xp6(2),k.Q6J("ngForOf",i.outFiles)("ngForTrackBy",n.trackByDataFile)}}function _i(t,e){if(1&t&&(k.TgZ(0,"div",117),k.YNc(1,Ti,2,0,"button",118),k.YNc(2,yi,3,0,"div",119),k._UZ(3,"br"),k.YNc(4,qi,3,2,"div",119),k.qZA()),2&t){var i=k.oxw(2).$implicit;k.xp6(1),k.Q6J("ngIf",!i.outFiles[0].id),k.xp6(1),k.Q6J("ngIf",i.outFiles[0].id),k.xp6(2),k.Q6J("ngIf",i.outFiles[0].id)}}function Ci(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"mat-tab"),k.YNc(1,vi,8,7,"ng-template",84),k.TgZ(2,"div",102),k.TgZ(3,"div",18),k.TgZ(4,"div",103),k.TgZ(5,"b"),k._uU(6,"Name"),k.qZA(),k.qZA(),k.TgZ(7,"div",104),k._uU(8),k.qZA(),k.qZA(),k.TgZ(9,"div",18),k.TgZ(10,"div",103),k.TgZ(11,"b"),k._uU(12,"Description"),k.qZA(),k.qZA(),k._UZ(13,"div",105),k.qZA(),k.TgZ(14,"div",18),k.TgZ(15,"div",103),k.TgZ(16,"b"),k._uU(17,"Timer"),k.qZA(),k.qZA(),k.YNc(18,wi,1,1,"div",106),k.qZA(),k.TgZ(19,"div",18),k.TgZ(20,"div",103),k.TgZ(21,"b"),k._uU(22,"Creation time"),k.qZA(),k.qZA(),k.TgZ(23,"div",104),k.TgZ(24,"p"),k._uU(25),k.qZA(),k.qZA(),k.qZA(),k.YNc(26,ki,7,1,"div",23),k.TgZ(27,"div",18),k.TgZ(28,"div",107),k._UZ(29,"display-arguments",108),k.qZA(),k.qZA(),k.TgZ(30,"div",18),k.TgZ(31,"div",34),k.TgZ(32,"button",75),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(),e=t.$implicit,n=t.index;return k.oxw(4).loadResultInfo(e.id,n)}),k._UZ(33,"i",109),k._uU(34," Refresh "),k.qZA(),k.qZA(),k.TgZ(35,"div",110),k.TgZ(36,"mat-tab-group",111),k.NdJ("selectedTabChange",function(t){k.CHM(i);var e=k.oxw().$implicit;return k.oxw(4).onResultTabChange(t,e.id)}),k.TgZ(37,"mat-tab",80),k.TgZ(38,"div",81),k._UZ(39,"chi-terminal",93),k.qZA(),k.qZA(),k.TgZ(40,"mat-tab",83),k.TgZ(41,"div",81),k._UZ(42,"chi-terminal",93),k.qZA(),k.qZA(),k.TgZ(43,"mat-tab"),k.YNc(44,bi,2,0,"ng-template",84),k.TgZ(45,"button",75),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().$implicit;return k.oxw(4).loadResultLogs(t.id)}),k._UZ(46,"i",112),k._uU(47," Refresh logs "),k.qZA(),k.TgZ(48,"mat-button-toggle-group",87),k.NdJ("ngModelChange",function(t){return k.CHM(i),k.oxw(5).taskLogViewMode=t}),k.TgZ(49,"mat-button-toggle",88),k._uU(50,"Table View"),k.qZA(),k.qZA(),k.TgZ(51,"div",81),k._UZ(52,"chi-tasklog-viewer",89),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k._UZ(53,"br"),k.YNc(54,_i,5,3,"div",113),k.qZA(),k.qZA()}if(2&t){var n=k.oxw().$implicit,r=k.oxw(4);k.xp6(8),k.Oqu(n.name),k.xp6(5),k.Q6J("innerHTML",n.desc||"(no description)",k.oJD),k.xp6(5),k.Q6J("ngIf",r.resultTimers[n.id]),k.xp6(7),k.Oqu(null==n||null==n.createdAt?null:n.createdAt.toString()),k.xp6(1),k.Q6J("ngIf",2==(null==n?null:n.status)||3==(null==n?null:n.status)),k.xp6(3),k.Q6J("theResult",n)("currentUser",r.currentUser)("parent",r.result),k.xp6(10),k.Q6J("text",null==n?null:n.stdOut),k.xp6(3),k.Q6J("text",null==n?null:n.stdErr),k.xp6(6),k.Q6J("ngModel",r.taskLogViewMode),k.xp6(4),k.Q6J("mode",r.taskLogViewMode)("taskLogs",r.resultTaskLogs[n.id])("resultID",n.id),k.xp6(2),k.Q6J("ngIf",n&&n.outFiles&&n.outFiles.length>0)}}function Si(t,e){if(1&t&&(k.ynx(0),k.YNc(1,Ci,55,15,"mat-tab",3),k.BQk()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngIf",i)}}function Ui(t,e){if(1&t&&(k.TgZ(0,"div",34),k.TgZ(1,"b"),k._uU(2),k.qZA(),k._uU(3),k.TgZ(4,"div"),k.TgZ(5,"mat-tab-group",100),k.YNc(6,Si,2,1,"ng-container",101),k.qZA(),k.qZA(),k.qZA()),2&t){var i=k.oxw(3);k.xp6(2),k.hij("Task(s) in Step ",i._viewControls.displayStep+1,""),k.xp6(1),k.hij(": ",i.getStepName(i._viewControls.displayStep)," "),k.xp6(3),k.Q6J("ngForOf",i.childResults[i._viewControls.displayStep])("ngForTrackBy",i.trackByResult)}}function Ri(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",18),k._UZ(1,"mat-divider"),k.YNc(2,ci,4,1,"div",78),k.TgZ(3,"div",34),k.TgZ(4,"b"),k._uU(5,"Progress"),k.qZA(),k.qZA(),k.TgZ(6,"div",34),k.TgZ(7,"button",75),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2);return t.showWorkflowGraph=!t.showWorkflowGraph}),k._UZ(8,"i",94),k._uU(9," Toggle workflow view"),k.qZA(),k.YNc(10,di,1,4,"bdp-workflow-planner",95),k.qZA(),k.YNc(11,fi,2,1,"div",78),k._UZ(12,"br"),k._UZ(13,"br"),k.YNc(14,Ui,7,4,"div",78),k.qZA()}if(2&t){var n=k.oxw(2);k.xp6(2),k.Q6J("ngIf",n.result.stdErr),k.xp6(8),k.Q6J("ngIf",n.showWorkflowGraph&&n.taskList&&n.result.task&&"workflow"===n.result.task.type),k.xp6(1),k.Q6J("ngIf",n.currentProject&&n.result),k.xp6(3),k.Q6J("ngIf",n._viewControls.displayStep>=0)}}function Ni(t,e){if(1&t&&(k.TgZ(0,"div"),k.TgZ(1,"div",18),k.TgZ(2,"div",19),k.TgZ(3,"b"),k._uU(4,"Result title"),k.qZA(),k.qZA(),k.TgZ(5,"div",20),k.YNc(6,Re,6,3,"p",3),k.YNc(7,Ne,11,5,"ng-container",3),k.qZA(),k.qZA(),k.TgZ(8,"div",18),k.TgZ(9,"div",19),k.TgZ(10,"b"),k._uU(11,"Description"),k.qZA(),k.qZA(),k.TgZ(12,"div",20),k.TgZ(13,"div",21),k.YNc(14,Pe,2,0,"p",3),k.TgZ(15,"p"),k._uU(16),k.qZA(),k.qZA(),k.YNc(17,Je,3,2,"mat-form-field",22),k.qZA(),k.qZA(),k.YNc(18,Ye,9,2,"div",23),k.TgZ(19,"div",18),k.TgZ(20,"div",19),k.TgZ(21,"b"),k._uU(22,"Task name"),k.qZA(),k.qZA(),k.TgZ(23,"div",20),k.TgZ(24,"p"),k._uU(25),k.YNc(26,Me,2,6,"a",24),k.qZA(),k.qZA(),k.qZA(),k.TgZ(27,"div",18),k.TgZ(28,"div",19),k.TgZ(29,"b"),k._uU(30,"Task description"),k.qZA(),k.qZA(),k.TgZ(31,"div",20),k._UZ(32,"p",25),k.qZA(),k.qZA(),k.TgZ(33,"div",18),k.TgZ(34,"div",19),k.TgZ(35,"b"),k._uU(36,"Runner"),k.qZA(),k.qZA(),k.TgZ(37,"div",20),k.TgZ(38,"p"),k._uU(39),k.qZA(),k.qZA(),k.qZA(),k.TgZ(40,"div",18),k.TgZ(41,"div",19),k.TgZ(42,"b"),k._uU(43,"Status"),k.qZA(),k.qZA(),k.TgZ(44,"div",26),k.YNc(45,Le,3,0,"p",27),k.YNc(46,Oe,3,0,"p",28),k.YNc(47,Be,3,0,"p",29),k.YNc(48,Fe,3,0,"p",30),k.YNc(49,$e,3,0,"p",31),k.qZA(),k.qZA(),k.TgZ(50,"div",18),k.TgZ(51,"div",19),k.TgZ(52,"b"),k._uU(53,"Duration"),k.qZA(),k.qZA(),k.TgZ(54,"div",20),k._UZ(55,"p",25),k.qZA(),k.qZA(),k.TgZ(56,"div",18),k.TgZ(57,"div",19),k.TgZ(58,"b"),k._uU(59,"Creation time"),k.qZA(),k.qZA(),k.TgZ(60,"div",20),k.TgZ(61,"p"),k._uU(62),k.qZA(),k.qZA(),k.qZA(),k.YNc(63,Ee,7,1,"div",23),k._UZ(64,"mat-divider"),k.YNc(65,Ke,6,1,"div",32),k._UZ(66,"mat-divider"),k.YNc(67,ni,3,1,"ng-container",3),k.TgZ(68,"div",33),k.TgZ(69,"div",34),k.TgZ(70,"p"),k.TgZ(71,"b"),k._uU(72,"Arguments"),k.qZA(),k.qZA(),k.qZA(),k.TgZ(73,"div",34),k._UZ(74,"display-arguments",35),k.qZA(),k.qZA(),k._UZ(75,"mat-divider"),k.YNc(76,ui,23,7,"div",32),k.YNc(77,Ri,15,4,"div",23),k.qZA()),2&t){var i=k.oxw();k.xp6(6),k.Q6J("ngIf",!i._viewControls.isEditing),k.xp6(1),k.Q6J("ngIf",i._viewControls.isEditing),k.xp6(6),k.Q6J("hidden",i._viewControls.isEditing),k.xp6(1),k.Q6J("ngIf",!(null!=i.result&&i.result.desc)),k.xp6(2),k.Oqu(null==i.result?null:i.result.desc),k.xp6(1),k.Q6J("ngIf",i._viewControls.isEditing),k.xp6(1),k.Q6J("ngIf",i.currentPackage),k.xp6(7),k.hij("",i.result.task&&i.result.task.name?i.result.task.name:i.result.taskSnapshot.name," "),k.xp6(1),k.Q6J("ngIf",i.currentPackage&&(null==i.currentPackage||null==i.currentPackage.privilege?null:i.currentPackage.privilege.canView)),k.xp6(6),k.Q6J("innerHTML",i.result.task&&i.result.task.desc?i.result.task.desc||"(no description)":i.result.taskSnapshot.desc||"(no description)",k.oJD),k.xp6(7),k.Oqu(i.result.owner?i.result.owner.name:"Unknown user"),k.xp6(5),k.Q6J("ngSwitch",null==i.result?null:i.result.status),k.xp6(1),k.Q6J("ngSwitchCase",0),k.xp6(1),k.Q6J("ngSwitchCase",1),k.xp6(1),k.Q6J("ngSwitchCase",2),k.xp6(1),k.Q6J("ngSwitchCase",3),k.xp6(1),k.Q6J("ngSwitchCase",4),k.xp6(6),k.Q6J("innerHTML",i.currentResultTimer,k.oJD),k.xp6(7),k.Oqu((null==i.result||null==i.result.createdAt?null:i.result.createdAt.toString())||"creation time undefined"),k.xp6(1),k.Q6J("ngIf",2==(null==i.result?null:i.result.status)||3==(null==i.result?null:i.result.status)),k.xp6(2),k.Q6J("ngIf",i.currentProject&&i.hasValidResultPages),k.xp6(2),k.Q6J("ngIf",i.result.task&&i.result.task.proxy),k.xp6(7),k.Q6J("theResult",i.result)("currentUser",i.currentUser)("expanded",!0),k.xp6(2),k.Q6J("ngIf","workflow"!==i.result.type),k.xp6(1),k.Q6J("ngIf","workflow"==i.result.type)}}function Pi(t,e){1&t&&k._UZ(0,"div",123)}function Ji(t,e){1&t&&k._UZ(0,"i",129)}function Ii(t,e){1&t&&k._UZ(0,"i",130)}var Qi=function(t,e){return{"fa-edit":t,"fa-save":e}};function Di(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"a",124),k.NdJ("click",function(){return k.CHM(i),k.oxw(3).onSave()}),k._UZ(1,"i",132),k.TgZ(2,"span",133),k._uU(3),k.qZA(),k.TgZ(4,"span",128),k._uU(5,"\u276f"),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(3);k.ekj("active",n._viewControls.isEditing),k.xp6(1),k.Q6J("ngClass",k.WLB(6,Qi,!n._viewControls.isEditing,n._viewControls.isEditing)),k.xp6(1),k.ekj("active",n.showRightButtonContent||n._viewControls.isEditing),k.xp6(1),k.Oqu(n._viewControls.isEditing?"Click to save":"Modify info")}}function Yi(t,e){if(1&t&&(k.ynx(0),k._UZ(1,"br"),k.YNc(2,Di,6,9,"a",131),k.BQk()),2&t){var i=k.oxw(2);k.xp6(2),k.Q6J("ngIf",!i.result.readOnly)}}var ji=function(t){return{result:t,proxy:"false"}};function Mi(t,e){if(1&t&&(k.ynx(0),k._UZ(1,"br"),k.TgZ(2,"a",134),k._UZ(3,"i",135),k.TgZ(4,"span",133),k._uU(5,"Result Page"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.BQk()),2&t){var i=k.oxw(2);k.xp6(2),k.Q6J("routerLink",k.DdM(4,ze))("queryParams",k.VKq(5,ji,i.result.id)),k.xp6(2),k.ekj("active",i.showRightButtonContent)}}var Li=function(t){return{result:t,proxy:"true"}};function Oi(t,e){if(1&t&&(k.ynx(0),k._UZ(1,"br"),k.TgZ(2,"a",134),k._UZ(3,"i",136),k.TgZ(4,"span",133),k._uU(5,"Proxy Page"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.BQk()),2&t){var i=k.oxw(2);k.xp6(2),k.Q6J("routerLink",k.DdM(4,ze))("queryParams",k.VKq(5,Li,i.result.id)),k.xp6(2),k.ekj("active",i.showRightButtonContent)}}function Bi(t,e){if(1&t){var i=k.EpF();k.ynx(0),k._UZ(1,"br"),k.TgZ(2,"a",124),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2);return t.stopResultDialog(t.result)}),k._UZ(3,"i",137),k.TgZ(4,"span",133),k._uU(5,"Stop"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw(2);k.xp6(4),k.ekj("active",n.showRightButtonContent)}}function Fi(t,e){if(1&t){var i=k.EpF();k.ynx(0),k._UZ(1,"br"),k.TgZ(2,"a",124),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2);return t.resumeResultDialog(t.result)}),k._UZ(3,"i",138),k.TgZ(4,"span",133),k._uU(5,"Resume"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw(2);k.xp6(4),k.ekj("active",n.showRightButtonContent)}}function $i(t,e){if(1&t){var i=k.EpF();k.ynx(0),k._UZ(1,"br"),k.TgZ(2,"a",124),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2);return t.deleteResultDialog(t.result)}),k._UZ(3,"i",139),k.TgZ(4,"span",133),k._uU(5,"Delete"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw(2);k.xp6(4),k.ekj("active",n.showRightButtonContent)}}function Ei(t,e){if(1&t){var i=k.EpF();k.ynx(0),k.TgZ(1,"a",124),k.NdJ("click",function(){k.CHM(i);var t=k.oxw();return t.showRightButtonContent=!t.showRightButtonContent}),k.YNc(2,Ji,1,0,"i",125),k.YNc(3,Ii,1,0,"i",126),k.TgZ(4,"span",127),k._uU(5,"MENU"),k.qZA(),k.TgZ(6,"span",128),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k.YNc(8,Yi,3,1,"ng-container",3),k.YNc(9,Mi,8,7,"ng-container",3),k.YNc(10,Oi,8,7,"ng-container",3),k.YNc(11,Bi,8,2,"ng-container",3),k.YNc(12,Fi,8,2,"ng-container",3),k.YNc(13,$i,8,2,"ng-container",3),k.BQk()}if(2&t){var n=k.oxw();k.xp6(2),k.Q6J("ngIf",n.showRightButtonContent),k.xp6(1),k.Q6J("ngIf",!n.showRightButtonContent),k.xp6(1),k.ekj("active",n.showRightButtonContent),k.xp6(4),k.Q6J("ngIf",n.currentProject.privilege.canEditResult),k.xp6(1),k.Q6J("ngIf",n.result&&n.currentProject.getValidResultPageKeys((null==n.result.task?null:n.result.task.key)||(null==n.result.taskSnapshot?null:n.result.taskSnapshot.key)||"").length>0),k.xp6(1),k.Q6J("ngIf",1===n.result.status&&n.result.task&&null!==n.result.task.proxy),k.xp6(1),k.Q6J("ngIf",n.result.status<2&&n.currentProject.privilege.canRun),k.xp6(1),k.Q6J("ngIf",3===n.result.status&&n.currentProject.privilege.canRun),k.xp6(1),k.Q6J("ngIf",n.currentProject.privilege.canDeleteResult)}}var zi=function(){return["/home"]},Hi=function(){return["/project/list"]},Vi=function(){var t=function(){function t(e,i,n,r,a,o,l,u){s(this,t),this.router=e,this.route=i,this.projectService=n,this.infoService=r,this.taskService=a,this.dialog=o,this.systemService=l,this.accountService=u,this.showRightButtonContent=!1,this.showWorkflowGraph=!1,this.timer$=(0,O.F)(1e3),this.taskList={},this.resultTaskLogs={},this.resultTimers={},this.taskLogViewMode="table",this.validProxyJobIds=[],this._viewControls={isLoading:!0,isEditing:!1,isDeleting:!1,workflowSteps:[[]],displayStepsInARow:5,childResultStatus:[],displayStep:-1,displayChildResults:[],displayChildResultIndex:0,confirmDelete:""},this.taskID2Task={},this.childResults=[],this.stepDisplay=[],this.currentResultTimer="",this._subs=[]}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.systemService.maintainRightSidebarStatus(),this.settingStepsInARow(),this._subs.push(this.accountService.currentUser$.subscribe(function(e){t.currentUser=e})),this._subs.push(this.timer$.subscribe(function(){for(var e=Object.keys(t.resultTimers),i=0;i<e.length;i++){var n=t.resultTimers[e[i]];n.timerDisplay=t.resultTimerDisplay(n.result)}t.result&&(t.currentResultTimer=t.resultTimerDisplay(t.result))})),this._subs.push(this.taskService.taskList$.subscribe(function(e){if(e&&e.length>0){t.taskList={};for(var i=0;i<e.length;i++){var n=e[i];t.taskList[n.id]=n,t.taskID2Task[n.id]=n}}})),this._subs.push(this.projectService.currentResult$.subscribe(function(e){!e||t.result&&e&&(e&&e.id===t.result.id?(t.result=void 0,t.childResults=[],setTimeout(function(){t.result=e,t.setCurrentPackage(),"workflow"===t.result.type&&t.prepareWorkflowChildren(),t.getProxyPages()},1)):e&&e.parent===t.result.id&&t.prepareWorkflowChildren(),t.resultTimers[e.id]={result:e,timerDisplay:t.resultTimerDisplay(e)})})),this._subs.push(this.projectService.currentProject$.subscribe(function(e){var i;e&&e.id!==(null===(i=t.currentProject)||void 0===i?void 0:i.id)&&(t.currentProject=e,Array.isArray(t.currentProject.packages)&&t.taskService.loadTasks(t.currentProject.packages.map(function(t){return t.id})),t.setCurrentPackage())})),this.route.queryParamMap.subscribe(function(e){t._viewControls.isEditing="1"===e.get("edit")}),this._subs.push(this.infoService.incomingMessage$.subscribe(function(e){"35"===e.code&&t.router.navigate(["/project/list"])})),this.route.paramMap.pipe((0,$.w)(function(e){var i=e.get("resultId");return i?t.projectService.loadResultInfo(i):(0,B.of)(new j.j({errors:["No resultId"]}))})).subscribe(function(e){e.isError||(t.result=e.success,t.result&&"workflow"===t.result.type&&t.prepareWorkflowChildren(),t._viewControls.isLoading=!1,t.systemService.toggleNavbar(!0),t.systemService.maintainRightSidebarStatus(),t.setCurrentPackage(),t.getProxyPages())}),momentDurationFormatSetup(M)}},{key:"hasValidResultPages",get:function(){return!!(this.currentProject&&this.result&&this.result.task&&this.result.task.key)&&this.currentProject.getValidResultPages(this.result.task.key).length>0}},{key:"setCurrentPackage",value:function(){var t=this;if(this.currentProject&&this.result){var e=null;if(this.result.task&&this.result.task.package?e=this.result.task.package:this.result.taskSnapshot&&this.result.taskSnapshot.package&&(e=this.result.taskSnapshot.package),e)var i=this.taskService.loadPackage(e,!0).subscribe(function(e){i.unsubscribe(),t.currentPackage=e.isError?void 0:e.success});else this.currentPackage=void 0}}},{key:"prepareWorkflowChildren",value:function(){this.childResults=this.getChildResults(),this.checkChildResultStatus(),this.stepDisplay=this.displayStep()}},{key:"settingStepsInARow",value:function(){if(this.resultInfoEl){var t=this.resultInfoEl.nativeElement.offsetWidth;this._viewControls.displayStepsInARow=t>=1400?7:t>=1024?5:t>=480?3:1,this.stepDisplay=this.displayStep()}}},{key:"displayStep",value:function(){for(var t=this._viewControls.displayStepsInARow,e=this.childResults,i=Math.ceil(e.length/t),n=[],r=0;r<i;r++)n[r]=e.slice(r*t,(r+1)*t);return n}},{key:"getChildResults",value:function(){var t=[[]];if(this.currentProject&&this.result)for(var e=this.currentProject.results,i=0;i<this.result.children.length;i++){var n=this.result.children[i];t[i]=[];for(var r=0;r<n.length;r++)for(var a=0;a<e.length;a++)e[a].id===n[r]&&(t[i][r]=e[a])}return t}},{key:"getProxyPages",value:function(){var t=this,e=[];if(this.result&&1===this.result.status&&this.result.task&&this.result.task.proxy)var i=this.projectService.getProxyJobsByResultId(this.result.id).subscribe(function(n){if(i.unsubscribe(),!n.isError){for(var r=n.success,a=0;a<r.length;a++)e.push(r[a].jobId);t.validProxyJobIds=e}});else this.validProxyJobIds.length=0}},{key:"cssResultStatus",value:function(t){var e={"fa-hourglass-half":!1,"fa-circle-o-notch":!1,"fa-check":!1,"fa-times":!1,"fa-trash":!1};if(t)switch(t){case 0:e["fa-hourglass-half"]=!0;break;case 1:e["fa-circle-o-notch"]=!0;break;case 2:e["fa-check"]=!0;break;case 3:e["fa-times"]=!0;break;case 4:e["fa-trash"]=!0}return e}},{key:"checkChildResultStatus",value:function(){if(this.result){var t=this._viewControls.childResultStatus;if(this.result.task&&this.result.task.mapper)for(var e=0;e<this.childResults.length;e++){var i=this.childResults[e];if(i.length>0){t[e]=2;for(var n=0;n<i.length;n++){var r=i[n];if(r){if(0===r.status){t[e]=0;break}if(1===r.status)t[e]=t[e]>1?1:t[e];else if(3===r.status){t[e]=3;break}}}}else t[e]=-1}}}},{key:"getStepName",value:function(t){var e,i=this,n="N/A";if(!this.result||(this.result.task&&this.result.task.id?e=this.result.task:this.result.taskSnapshot&&this.result.taskSnapshot.id&&(e=this.result.taskSnapshot),!e)||Array.isArray(e.stepNames)&&(n=e.stepNames[t]))return n;if(e.mapper){var r=e.mapper[t];r&&(n="["+r.map(function(t){return t.id&&i.taskID2Task[t.id]?i.taskID2Task[t.id].name:""}).join(", ")+"]")}else this.childResults[t]&&(n=this.childResults[t].map(function(t){return t.name}).join(", "));return n}},{key:"gotoProject",value:function(){var t=this.result?this.result.project:this.currentProject?this.currentProject.id:void 0;t&&this.router.navigate(["/project/"+t+"/info"])}},{key:"onSave",value:function(){var t=this;if(this._viewControls.isEditing&&this.result){this._viewControls.isEditing=!1;var e=this.projectService.updateResultInfo(this.result).subscribe(function(i){e.unsubscribe(),t.result=i.success})}else this._viewControls.isEditing=!0}},{key:"trackByDataFile",value:function(t,e){return e.id?e.id:void 0}},{key:"trackByResult",value:function(t,e){return e.id?e.id:void 0}},{key:"loadResultInfo",value:function(t,e){this._viewControls.displayChildResultIndex=e;var i=this.projectService.loadResultInfo(t).subscribe(function(){return i.unsubscribe()})}},{key:"resultTimerDisplay",value:function(t){if(!t)return"";var e,i,n,r,a,s;if("workflow"!==t.type){if(0===t.status)return e=M(t.timer[0]),r=M().diff(e),"The task is currently in queue and has waited for around <b>\n          ".concat(M.duration(r).format("hh:mm:ss",{trim:!1}),"</b>.");if(1===t.status)return e=M(t.timer[0]),i=M(t.timer[1]),s=M(),r=i.diff(e),a=s.diff(i),"The task waited for\n          <b>".concat(M.duration(r).format("hh:mm:ss.S",{trim:!1}),"</b> and is currently running for\n          <b>").concat(M.duration(a).format("hh:mm:ss",{trim:!1}),"</b>.");if(2===t.status||3===t.status)return e=M(t.timer[0]),i=M(t.timer[1]),n=M(t.timer[2]),r=i.diff(e),a=n.diff(i),"The task waited for <b> ".concat(M.duration(r).format("hh:mm:ss.S",{trim:!1}),"</b> and then took <b>").concat(M.duration(a).format("hh:mm:ss.S",{trim:!1}),"</b> to finish.")}else{if(1===t.status)return i=M(t.timer[0]),a=(s=M()).diff(i),"This task is currently running for <b>".concat(M.duration(a).format("hh:mm:ss",{trim:!1}),"</b>.");if(2===t.status||3===t.status)return i=M(t.timer[0]),a=(n=M(t.timer[1])).diff(i),"The task took <b>".concat(M.duration(a).format("hh:mm:ss.S",{trim:!1}),"</b> to finish.")}return""}},{key:"stopResult",value:function(t,e){var i=this.projectService.stopResult(t).subscribe(function(){return i.unsubscribe()})}},{key:"resumeResult",value:function(t){var e=this.projectService.resumeResult(t.id).subscribe(function(){return e.unsubscribe()})}},{key:"stopResultDialog",value:function(t){var e=this,i=this.dialog.open(F.N,{disableClose:!1});i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to stop the processes <strong>'.concat(t.name,"</strong>'?</h4>"),desc:'<span class="text-danger">This will stop the processes, name: <b>'.concat(t.name,"</b><br>This cannot be undone. Make sure this is something you really want to do!</span><br>")}),i.afterClosed().subscribe(function(i){i&&e.stopResult(t,i)})}},{key:"resumeResultDialog",value:function(t){var e=this,i=this.dialog.open(F.N,{disableClose:!1});i.componentInstance.setOptions({title:'<h4 class="modal-title text-primary">Are you sure you want to resume or re-run the process <strong>'.concat(t.name,"</strong>'?</h4>"),desc:'<span class="text-primary">This will resume/re-run the processes, name: <b>'.concat(t.name,"</b><br>")}),i.afterClosed().subscribe(function(i){i&&e.resumeResult(t)})}},{key:"deleteResult",value:function(t,e){var i=this,n=this.projectService.deleteResult(t).subscribe(function(e){if(n.unsubscribe(),!e.isError){t.status=4;var r=i.result?i.result.project:i.currentProject?i.currentProject.id:t.project;r&&i.router.navigate(["/project",r,"result","list"])}})}},{key:"deleteResultDialog",value:function(t){var e=this,i=this.dialog.open(F.N,{disableClose:!1});i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to delete the result <strong>'.concat(t.name,"</strong>'?</h4>"),desc:'<span class="text-danger">This will delete the result, name: <b>'.concat(t.name,"</b>, and all the associated outputs. <br>This cannot be undone. Make sure this is something you really want to do!</span><br>")}),i.afterClosed().subscribe(function(i){i&&e.deleteResult(t,i)})}},{key:"showStep",value:function(t){if(this.result)if(this._viewControls.displayStep===t)this._viewControls.displayStep=-1;else if(this._viewControls.displayStep=t,this._viewControls.displayChildResultIndex=0,this._viewControls.displayStep>=0){var e=this.childResults[this._viewControls.displayStep][0];e&&this.loadResultInfo(e.id,0)}}},{key:"onResultTabChange",value:function(t,e){2===t.index&&this.loadResultLogs(e)}},{key:"loadResultLogs",value:function(t){var e=this;this.resultTaskLogs[t]=[];var i=this.projectService.getResultLogs(t).subscribe(function(n){i.unsubscribe();var r=n.success.split("\n").map(function(t){return t.split("\t")}),a=r[0];e.resultTaskLogs[t]=r.slice(1).map(function(t,e){var i={index:e};return t.forEach(function(t,e){return i[a[e]]=t}),new L(i)}).filter(function(t){return!(""===t.process&&"undefined"===t.taskName)})})}},{key:"ngOnDestroy",value:function(){this._subs.forEach(function(t){return t.unsubscribe()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.Y36(D.F0),k.Y36(D.gz),k.Y36(E.Y),k.Y36(z.C),k.Y36(H.M),k.Y36(V.uw),k.Y36(X.o),k.Y36(W.B))},t.\u0275cmp=k.Xpm({type:t,selectors:[["result-info"]],viewQuery:function(t,e){var i;(1&t&&k.Gf(ve,7),2&t)&&(k.iGM(i=k.CRH())&&(e.resultInfoEl=i.first))},decls:27,vars:15,consts:[[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[4,"ngIf"],[3,"routerLink","click",4,"ngIf"],["class","breadcrumb-item",4,"ngIf"],[3,"routerLink",4,"ngIf"],["class","breadcrumb-item active",4,"ngIf"],[1,"bdp-main-container"],[1,"chi-header"],[1,"container-fluid",2,"height","100%"],["resultInfoContainer",""],["class","overlay",4,"ngIf"],[1,"chi-right-menu"],[3,"routerLink","click"],[1,"breadcrumb-item","active"],["target","_blank",3,"routerLink"],[1,"fas","fa-external-link-alt","ms-3"],[1,"row"],[1,"col-md-3","col-lg-2"],[1,"col-md-9","col-lg-10"],[3,"hidden"],["style","width: 100%;",4,"ngIf"],["class","row",4,"ngIf"],["target","_blank",3,"routerLink","queryParams",4,"ngIf"],[3,"innerHTML"],[1,"col-md-9","col-lg-10",3,"ngSwitch"],["class","text-info",4,"ngSwitchCase"],["class","text-primary",4,"ngSwitchCase"],["class","text-success",4,"ngSwitchCase"],["class","text-danger",4,"ngSwitchCase"],["class","text-warning",4,"ngSwitchCase"],["class","row my-2",4,"ngIf"],[1,"row","mt-2","mb-4"],[1,"col-12"],[3,"theResult","currentUser","expanded"],[1,"text-muted",2,"white-space","pre"],[2,"width","50%"],["matInput","","type","text","maxlength","36","size","36","placeholder","The prefix for this result record.",3,"ngModel","ngModelChange"],["matInput","","type","text","maxlength","36","size","36","placeholder","The suffix for this result record.",3,"ngModel","ngModelChange"],[2,"width","100%"],["matInput","","type","text","maxlength","80","size","80","placeholder","The result title (length must be smaller or equal than 80 characters)",3,"ngModel","ngModelChange"],["matPrefix",""],[1,"text-muted",2,"white-space","pre",3,"innerHTML"],["matSuffix",""],["matInput","","placeholder","Say something about this subset. (max length: 160 characters)","maxlength","160","rows","3",3,"ngModel","ngModelChange"],[1,"fas","fa-cube","fa-fw","me-2"],["target","_blank",3,"routerLink","queryParams"],[1,"fas","fa-external-link-alt","fa-fw","ms-2"],[1,"text-info"],["aria-hidden","true",1,"fas","fa-hourglass-half","fa-fw"],[1,"text-primary"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin","fa-fw"],[1,"text-success"],["aria-hidden","true",1,"fas","fa-check","fa-fw"],[1,"text-danger"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],[1,"text-warning"],["aria-hidden","true",1,"fas","fa-trash-alt","fa-fw"],[1,"row","my-2"],[4,"ngFor","ngForOf"],[1,"col-lg-3","ps-4"],[1,"text-muted","ms-4"],[1,"me-3",2,"display","inline-block"],[1,"fas","fa-cube","fa-lg","me-2"],[2,"display","inline-block"],[1,"fas","fa-cubes","fa-lg","me-2"],[1,"col-lg-9","p-2"],["mat-stroked-button","","class","ms-2 mb-2",3,"routerLink","queryParams",4,"ngFor","ngForOf"],["mat-stroked-button","",1,"ms-2","mb-2",3,"routerLink","queryParams"],[1,"me-2","fas","fa-scroll","fa-fw"],["mat-icon-button","","color","primary","aria-label","refresh the available proxy pages",3,"click"],[1,"fas","fa-sync","fa-lg","fa-fw"],[1,"col-12","ps-4"],["mat-stroked-button","",3,"routerLink","queryParams",4,"ngFor","ngForOf"],["mat-button","",3,"click"],["mat-stroked-button","",3,"routerLink","queryParams"],[1,"me-2","fas","fa-network-wired","fa-fw"],["class","col-12",4,"ngIf"],["animationDuration","0ms",2,"min-height","600px",3,"selectedTabChange"],["label","Standard output"],[2,"width","100%","overflow","auto"],[3,"text",4,"ngIf"],["label","System message"],["mat-tab-label",""],["mat-button","",2,"min-width","0.1%",3,"click"],[1,"fas","fa-sync","fa-fx","me-2",2,"color","green"],["name","fontStyle","aria-label","Font Style",3,"ngModel","ngModelChange"],["value","table"],[3,"mode","taskLogs","resultID"],["role","alert",1,"alert","alert-danger"],["class","ms-4",4,"ngFor","ngForOf"],[1,"ms-4"],[3,"text"],[1,"fas","fa-project-diagram"],["style","width: 100%;",3,"taskMapper","childTasks","taskArgs","resultList",4,"ngIf"],[1,"fas","fa-exclamation-triangle","me-2"],[2,"width","100%",3,"taskMapper","childTasks","taskArgs","resultList"],[3,"currentProject","currentResult","taskID2Task","stepSelect",4,"ngIf"],[3,"currentProject","currentResult","taskID2Task","stepSelect"],["animationDuration","0ms"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"container-fluid"],[1,"col-md-3"],[1,"col-md-9"],[1,"col-md-9",3,"innerHTML"],["class","col-md-9",3,"innerHTML",4,"ngIf"],[1,"col-12","my-2"],[3,"theResult","currentUser","parent"],[1,"fas","fa-sync",2,"color","green"],[1,"col-md-12"],["animationDuration","0ms",2,"min-height","800px",3,"selectedTabChange"],[1,"fas","fa-sync","fa-fx",2,"color","green"],["class","row px-2",4,"ngIf"],[3,"click"],[3,"ngSwitch"],["aria-hidden","true",1,"fas","fa-trash","fa-fw"],[1,"row","px-2"],["md-raised-button","",3,"click",4,"ngIf"],["class","col-md-12",4,"ngIf"],["md-raised-button","",3,"click"],["class","col-lg-6 col-xl-4",3,"dataFile",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-lg-6","col-xl-4",3,"dataFile"],[1,"overlay"],[1,"chi-rbtn",3,"click"],["class","fa fa-angle-right fa-fw",4,"ngIf"],["class","fa fa-angle-left fa-fw",4,"ngIf"],[1,"chi-rbtn-content","ms-2"],[1,"chi-rbtn-arrow"],[1,"fa","fa-angle-right","fa-fw"],[1,"fa","fa-angle-left","fa-fw"],["class","chi-rbtn",3,"active","click",4,"ngIf"],["aria-hidden","true",1,"fas",3,"ngClass"],[1,"chi-rbtn-content"],[1,"chi-rbtn",3,"routerLink","queryParams"],[1,"fas","fa-scroll","fa-fw"],[1,"fas","fa-network-wired","fa-fw"],[1,"far","fa-stop-circle","fa-fw"],[1,"far","fa-play-circle","fa-fw"],[1,"fas","fa-trash","fa-fw"]],template:function(t,e){1&t&&(k.TgZ(0,"ol",0),k.TgZ(1,"li",1),k.TgZ(2,"a",2),k._uU(3,"Home"),k.qZA(),k.qZA(),k.TgZ(4,"li",1),k.TgZ(5,"a",2),k._uU(6,"Project List"),k.qZA(),k.qZA(),k.TgZ(7,"li",1),k.YNc(8,we,2,0,"a",3),k.YNc(9,Te,3,4,"a",4),k.qZA(),k.YNc(10,ye,2,0,"li",5),k.TgZ(11,"li",1),k.YNc(12,qe,2,3,"a",6),k.qZA(),k.YNc(13,Ce,5,6,"li",7),k.YNc(14,Se,2,0,"li",7),k.qZA(),k.TgZ(15,"div",8),k.TgZ(16,"h4",9),k._uU(17,"Result information"),k.qZA(),k.YNc(18,Ue,2,0,"div",3),k._UZ(19,"br"),k._UZ(20,"br"),k.TgZ(21,"div",10,11),k.YNc(23,Ni,78,27,"div",3),k.YNc(24,Pi,1,0,"div",12),k.qZA(),k.qZA(),k.TgZ(25,"div",13),k.YNc(26,Ei,14,10,"ng-container",3),k.qZA()),2&t&&(k.xp6(2),k.Q6J("routerLink",k.DdM(13,zi)),k.xp6(3),k.Q6J("routerLink",k.DdM(14,Hi)),k.xp6(3),k.Q6J("ngIf",!e.currentProject),k.xp6(1),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",void 0===e.result),k.xp6(2),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",e.result),k.xp6(1),k.Q6J("ngIf",!e.result),k.xp6(4),k.Q6J("ngIf",e._viewControls.isLoading),k.xp6(5),k.Q6J("ngIf",!e._viewControls.isLoading&&void 0!==e.result),k.xp6(1),k.Q6J("ngIf",e._viewControls.isDeleting),k.xp6(1),k.Q6J("@rightButtonState",e.showRightButtonContent?"active":"inactive"),k.xp6(1),k.Q6J("ngIf",e.result&&e.currentProject))},directives:[D.yS,l.O5,l.RF,l.n9,v.d,Zt,xt.KE,f.Nt,u.Fj,u.nD,u.JJ,u.On,xt.qo,xt.R9,l.sg,c.zs,c.lW,p.SP,p.uX,p.uD,d.A9,d.Yi,ae,se.O,oe.t,Ze,xe.A,l.mk],styles:['.wrap[_ngcontent-%COMP%]{width:100%;height:30px;white-space:nowrap;overflow:hidden;margin-top:5px;transform-style:preserve-3d;perspective:1600px}.wrap[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{margin-left:-1%}.workflowProgress[_ngcontent-%COMP%]{margin:0 0 0 .5%;height:30px;position:relative;display:inline-block;text-align:left;line-height:30px;transition:all .8s;cursor:pointer}.workflowProgress[_ngcontent-%COMP%]:before, .workflowProgress[_ngcontent-%COMP%]:after{content:"";position:absolute;transition:all .8s;z-index:-1}.workflowProgress[_ngcontent-%COMP%]:before{height:15px;width:100%;top:0;left:0;background:lightgray;transform:skew(45deg)}.workflowProgress[_ngcontent-%COMP%]:after{height:15px;width:100%;top:14px;left:0;background:lightgray;transform:skew(-45deg)}.workflowProgress.success[_ngcontent-%COMP%]:before, .workflowProgress.success[_ngcontent-%COMP%]:after{background:lightgreen}.workflowProgress.error[_ngcontent-%COMP%]:before, .workflowProgress.error[_ngcontent-%COMP%]:after{background:lightcoral}.workflowProgress.processing[_ngcontent-%COMP%]:before, .workflowProgress.processing[_ngcontent-%COMP%]:after{background:sandybrown}.workflowProgress.active[_ngcontent-%COMP%]:before, .workflowProgress.active[_ngcontent-%COMP%]:after{transition:all .3s cubic-bezier(.25,.8,.25,1)}.workflowProgress.blur[_ngcontent-%COMP%]:before, .workflowProgress.blur[_ngcontent-%COMP%]:after{opacity:.3}.mat-tab-body-content[_ngcontent-%COMP%]{overflow:hidden!important}'],data:{animation:[Y.M]}}),t}(),Xi=a(78968),Wi=a(31680);function Ki(t,e){1&t&&k._UZ(0,"th",38)}function Gi(t,e){1&t&&(k.ynx(0),k._UZ(1,"i",41),k.BQk())}function tn(t,e){1&t&&(k.ynx(0),k._UZ(1,"i",42),k.BQk())}function en(t,e){if(1&t&&(k.TgZ(0,"td",39),k.YNc(1,Gi,2,0,"ng-container",40),k.YNc(2,tn,2,0,"ng-container",40),k.qZA()),2&t){var i=e.$implicit,n=k.oxw();k.uIk("rowspan",n.expandedResults.has(i.id)?2:1),k.xp6(1),k.Q6J("ngIf",n.expandedResults.has(i.id)),k.xp6(1),k.Q6J("ngIf",!n.expandedResults.has(i.id))}}function nn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Project name"),k.qZA())}var rn=function(t){return["/project",t,"info"]};function an(t,e){if(1&t&&(k.TgZ(0,"a",2),k._uU(1),k.qZA()),2&t){var i=k.oxw().$implicit,n=k.oxw();k.Q6J("routerLink",k.VKq(2,rn,n.resultID2Project[i.id].id)),k.xp6(1),k.Oqu(null==n.resultID2Project[i.id]?null:n.resultID2Project[i.id].name)}}function sn(t,e){if(1&t&&(k.TgZ(0,"td",44),k.YNc(1,an,2,4,"a",45),k.TgZ(2,"a",46),k._UZ(3,"span",47),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw();k.xp6(1),k.Q6J("ngIf",i.project),k.xp6(1),k.Q6J("routerLink",k.VKq(2,rn,n.resultID2Project[i.id].id))}}function on(t,e){1&t&&(k.TgZ(0,"th",48),k._uU(1,"Type"),k.qZA())}function ln(t,e){1&t&&k._UZ(0,"i",55)}function un(t,e){1&t&&k._UZ(0,"i",56)}function cn(t,e){1&t&&k._UZ(0,"i",57)}function dn(t,e){1&t&&k._UZ(0,"i",58)}function gn(t,e){if(1&t&&(k.TgZ(0,"td",49),k.TgZ(1,"div",50),k.YNc(2,ln,1,0,"i",51),k.YNc(3,un,1,0,"i",52),k.YNc(4,cn,1,0,"i",53),k.YNc(5,dn,1,0,"i",54),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngSwitch",null==i?null:i.type),k.xp6(1),k.Q6J("ngSwitchCase","workflow"),k.xp6(1),k.Q6J("ngSwitchCase","standard"),k.xp6(1),k.Q6J("ngSwitchCase","child"),k.xp6(1),k.Q6J("ngSwitchCase","system")}}function fn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Prefix"),k.qZA())}function pn(t,e){if(1&t&&(k.TgZ(0,"td",59),k.TgZ(1,"u",60),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(i.prefix)}}function hn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Result name"),k.qZA())}var mn=function(t){return["/result",t,"info"]};function Zn(t,e){if(1&t&&(k.TgZ(0,"td",61),k.TgZ(1,"a",2),k._uU(2),k.qZA(),k.TgZ(3,"a",46),k._UZ(4,"span",47),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("routerLink",k.VKq(3,mn,i.id)),k.xp6(1),k.Oqu(null==i?null:i.name),k.xp6(1),k.Q6J("routerLink",k.VKq(5,mn,i.id))}}function xn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Suffix"),k.qZA())}function vn(t,e){if(1&t&&(k.TgZ(0,"td",62),k.TgZ(1,"u",60),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(i.suffix)}}function wn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Updated time"),k.qZA())}function kn(t,e){if(1&t&&(k.TgZ(0,"td",63),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(null==i||null==i.updatedAt?null:i.updatedAt.format("YYYY/MM/DD HH:mm:ss"))}}function bn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Status"),k.qZA())}function Tn(t,e){1&t&&(k.TgZ(0,"p",69),k._UZ(1,"i",70),k.qZA())}function yn(t,e){1&t&&(k.TgZ(0,"p",71),k._UZ(1,"i",72),k.qZA())}function An(t,e){1&t&&(k.TgZ(0,"p",73),k._UZ(1,"i",74),k.qZA())}function qn(t,e){1&t&&(k.TgZ(0,"p",75),k._UZ(1,"i",76),k.qZA())}function _n(t,e){1&t&&(k.TgZ(0,"p",77),k._UZ(1,"i",78),k.qZA())}function Cn(t,e){if(1&t&&(k.TgZ(0,"td",63),k.TgZ(1,"div",50),k.YNc(2,Tn,2,0,"p",64),k.YNc(3,yn,2,0,"p",65),k.YNc(4,An,2,0,"p",66),k.YNc(5,qn,2,0,"p",67),k.YNc(6,_n,2,0,"p",68),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngSwitch",null==i?null:i.status),k.xp6(1),k.Q6J("ngSwitchCase",0),k.xp6(1),k.Q6J("ngSwitchCase",1),k.xp6(1),k.Q6J("ngSwitchCase",2),k.xp6(1),k.Q6J("ngSwitchCase",3),k.xp6(1),k.Q6J("ngSwitchCase",4)}}function Sn(t,e){1&t&&(k.TgZ(0,"th",43),k._uU(1,"Owner"),k.qZA())}function Un(t,e){if(1&t&&(k.TgZ(0,"td",63),k.TgZ(1,"span"),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(null==i||null==i.owner?null:i.owner.name)}}function Rn(t,e){if(1&t&&k._UZ(0,"chi-terminal",92),2&t){var i=k.oxw(3).$implicit;k.Q6J("text",null==i?null:i.stdOut)}}function Nn(t,e){if(1&t&&(k.TgZ(0,"div",89),k.YNc(1,Rn,1,1,"chi-terminal",91),k.qZA()),2&t){var i=k.oxw(2).$implicit;k.xp6(1),k.Q6J("ngIf",i)}}function Pn(t,e){if(1&t&&k._UZ(0,"chi-terminal",92),2&t){var i=k.oxw(3).$implicit;k.Q6J("text",null==i?null:i.stdErr)}}function Jn(t,e){if(1&t&&(k.TgZ(0,"div",89),k.YNc(1,Pn,1,1,"chi-terminal",91),k.qZA()),2&t){var i=k.oxw(2).$implicit;k.xp6(1),k.Q6J("ngIf",i)}}function In(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",93),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2).$implicit;return k.oxw().loadResultLogs(t.id)}),k._uU(1,"Task logs"),k.qZA()}}function Qn(t,e){if(1&t){var i=k.EpF();k.ynx(0),k._UZ(1,"display-arguments",81),k.TgZ(2,"mat-tab-group",82),k.NdJ("selectedTabChange",function(t){k.CHM(i);var e=k.oxw().$implicit;return k.oxw().onResultTabChange(t,e.id)}),k.TgZ(3,"mat-tab",83),k.YNc(4,Nn,2,1,"ng-template",84),k.qZA(),k.TgZ(5,"mat-tab",85),k.YNc(6,Jn,2,1,"ng-template",84),k.qZA(),k.TgZ(7,"mat-tab"),k.YNc(8,In,2,0,"ng-template",86),k.TgZ(9,"button",87),k.NdJ("click",function(){k.CHM(i);var t=k.oxw().$implicit;return k.oxw().loadResultLogs(t.id)}),k._UZ(10,"i",88),k._uU(11," Refresh logs "),k.qZA(),k.TgZ(12,"div",89),k._UZ(13,"chi-tasklog-viewer",90),k.qZA(),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw().$implicit,r=k.oxw();k.xp6(1),k.Q6J("theResult",n)("currentUser",r.currentUser),k.xp6(1),k.Q6J("selectedIndex",0),k.xp6(11),k.Q6J("taskLogs",r.resultTaskLogs[n.id])("resultID",n.id)}}function Dn(t,e){if(1&t&&(k.ynx(0),k._UZ(1,"mat-progress-bar",94),k._UZ(2,"display-arguments",81),k.BQk()),2&t){var i=k.oxw().$implicit,n=k.oxw();k.xp6(1),k.Q6J("color","primary")("mode","buffer")("value",n.workflowProgresses[i.id].value)("bufferValue",n.workflowProgresses[i.id].bufferValue),k.xp6(1),k.Q6J("theResult",i)("currentUser",n.currentUser)}}function Yn(t,e){if(1&t&&(k.TgZ(0,"td",79),k.TgZ(1,"div",80),k.YNc(2,Qn,14,5,"ng-container",40),k.YNc(3,Dn,3,6,"ng-container",40),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw();k.uIk("colspan",n.expandedResults.has(i.id)?8:9),k.xp6(1),k.Q6J("@detailExpand",n.expandedResults.has(i.id)?"expanded":"collapsed"),k.xp6(1),k.Q6J("ngIf","workflow"!==i.type),k.xp6(1),k.Q6J("ngIf","workflow"===i.type)}}function jn(t,e){1&t&&k._UZ(0,"tr",95)}function Mn(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"tr",96),k.NdJ("click",function(){var t=k.CHM(i).$implicit;return k.oxw().toggleRow(t.id)}),k.qZA()}if(2&t){var n=e.$implicit,r=e.dataIndex,a=k.oxw();k.ekj("table-warning",r==a.newTaskIndex)("table-primary",r!=a.newTaskIndex&&a.expandedResults.has(n.id))}}function Ln(t,e){1&t&&k._UZ(0,"tr",97)}var On=function(){return["/home"]},Bn=function(){return["/project/list"]},Fn=function(){return["/result/activities"]},$n=function(){return[10,30]},En=function(){return["expander","resultType","projectName","resultPrefix","resultName","resultSuffix","resultStatus","resultOwner","resultUpdateTime"]},zn=function(){return["resultDetail"]},Hn=function(){return[5,10,25,50,100,300]},Vn=function(){var t=function(){function t(e,i,n,r,a,o){s(this,t),this.projectService=e,this.accountService=i,this.route=n,this.systemService=r,this.infoService=a,this.router=o,this.pageSize=30,this.pageIndex=0,this.totalPage=0,this.totalCount=0,this.activities=[],this.loadedResultID2Result={},this.expandedResults=new Set,this.resultID2Project={},this.workflowProgresses={},this.newTaskIndex=1,this.resultTaskLogs={},this._subs=[]}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.systemService.maintainRightSidebarStatus(),this._subs.push(this.infoService.incomingDataChange$.subscribe(function(e){var i=e.type;if("Result"===e.target){var n=e.data;"insert"===i&&!n.parent&&(t.resultID2Project[n.id]=n.project,n=new Wi.x(n),t.loadedResultID2Result[n.id]=n,t.newTaskIndex++,t.activities.unshift(n),"workflow"===n.type&&(t.workflowProgresses[n.id]=2===n.status?{value:100,bufferValue:0}:t.calculateWorkflowProgress(n))),t.loadedResultID2Result[n.id]&&("update"===i?t.updateResult(n):"remove"===i&&t.removeResult(n))}})),this._subs.push(this.infoService.incomingResultOutput$.subscribe(function(e){var i=e.target.split(":")[1],n=t.loadedResultID2Result[i];n&&"workflow"!==n.type&&("stdOut"===e.type?n.stdOut=e.data:"stdErr"===e.type&&(n.stdErr=e.data))})),this._subs.push(this.accountService.currentUser$.subscribe(function(e){t.currentUser=e})),this.route.queryParamMap.pipe((0,$.w)(function(e){var i=e.get("pageIndex"),n=e.get("pageSize");return t.pageIndex=i?+i:t.pageIndex,t.pageSize=n?+n:t.pageSize,t.projectService.getActivities(t.pageIndex,t.pageSize)})).subscribe(function(e){return e.isError?"":t.processActivities(e)})}},{key:"updateResult",value:function(t){for(var e=0;e<this.activities.length;e++){var i=this.activities[e];if(t.id===i.id){this.activities[e].name=t.name,this.activities[e].desc=t.desc,this.activities[e].prefix=t.prefix,this.activities[e].suffix=t.suffix,this.activities[e].status=t.status,this.activities[e].owner=t.owner,this.activities[e].updatedAt=M(t.updatedAt),"workflow"===t.type&&this.workflowProgresses[i.id]&&(this.workflowProgresses[i.id]=2===i.status?{value:100,bufferValue:0}:this.calculateWorkflowProgress(t));break}}this.activityTable&&this.activityTable.renderRows()}},{key:"removeResult",value:function(t){for(var e=0;e<this.activities.length;e++)if(t.id===this.activities[e].id){this.activities.splice(e,1);break}delete this.loadedResultID2Result[t.id],delete this.workflowProgresses[t.id],this.activityTable&&this.activityTable.renderRows()}},{key:"processActivities",value:function(t){this.newTaskIndex=-1,this.totalPage=t.success.totalPage,this.totalCount=t.success.totalCount;var e=t.success.records;this.resultID2Project=t.success.resultID2Project;var i=e.length;this.loadedResultID2Result={};for(var n=0;n<i;n++){var r=e[n];this.loadedResultID2Result[r.id]=r,"workflow"===r.type&&(this.workflowProgresses[r.id]=2===r.status?{value:100,bufferValue:0}:this.calculateWorkflowProgress(r))}this.activities=e}},{key:"reloadActivities",value:function(){var t=this,e=this.projectService.getActivities(this.pageIndex,this.pageSize).subscribe(function(i){e.unsubscribe(),i.isError||t.processActivities(i)})}},{key:"calculateWorkflowProgress",value:function(t){if("workflow"!==t.type)return{value:0,bufferValue:0};for(var e=t.task&&Array.isArray(t.task.mapper)?t.task.mapper.length:t.taskSnapshot.mapper.length,i=t.children||[],n=[],r=0;r<e;r++)if(Array.isArray(t.task.mapper)){var a=t.task.mapper[r].length,s=Array.isArray(i[r])?i[r].filter(function(t){return!!t}):[];if(0===s.length)break;n[r]=0,s.length===a&&r<e-1?n[r]=2:0===s.length&&r>=1&&2===n[r-1]?n[r-1]=1:s.length===a&&r===e-1&&2!==t.status&&(n[r]=1)}return{value:100*n.filter(function(t){return 2===t}).length/e,bufferValue:100*n.filter(function(t){return 1===t}).length/e}}},{key:"onPageChange",value:function(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize,this.router.navigate(["result","activities"],{queryParams:{pageIndex:this.pageIndex,pageSize:this.pageSize}})}},{key:"toggleRow",value:function(t){this.expandedResults.has(t)?this.expandedResults.delete(t):this.expandedResults.add(t)}},{key:"onResultTabChange",value:function(t,e){2===t.index&&this.loadResultLogs(e)}},{key:"loadResultLogs",value:function(t){var e=this,i=this.projectService.getResultLogs(t).subscribe(function(n){i.unsubscribe();var r=n.success.split("\n").map(function(t){return t.split("\t")}),a=r[0];e.resultTaskLogs[t]=r.slice(1).map(function(t){var e={};return t.forEach(function(t,i){return e[a[i]]=t}),new L(e)}).filter(function(t){return!(""===t.process&&"undefined"===t.taskName)})})}},{key:"ngOnDestroy",value:function(){this._subs.forEach(function(t){return t.unsubscribe()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.Y36(E.Y),k.Y36(W.B),k.Y36(D.gz),k.Y36(X.o),k.Y36(z.C),k.Y36(D.F0))},t.\u0275cmp=k.Xpm({type:t,selectors:[["result-activity"]],viewQuery:function(t,e){var i;(1&t&&k.Gf(m.BZ,5),2&t)&&(k.iGM(i=k.CRH())&&(e.activityTable=i.first))},decls:57,vars:25,consts:[[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["target","_blank",3,"routerLink"],[1,"fas","fa-external-link-alt","ms-3"],[1,"bdp-main-container"],[1,"chi-header"],["mat-stroked-button","",3,"click"],[1,"fas","fa-redo","me-2"],[1,"table-responsive"],[3,"pageSizeOptions","pageSize","pageIndex","length","page"],["mat-table","","multiTemplateDataRows","",1,"table","table-striped","table-bordered","table-hover",3,"dataSource"],["activityTable",""],["matColumnDef","expander"],["mat-header-cell","","class","align-middle",4,"matHeaderCellDef"],["mat-cell","","class","link align-middle text-center p-0",4,"matCellDef"],["matColumnDef","projectName"],["mat-header-cell","","class","align-middle  text-center",4,"matHeaderCellDef"],["mat-cell","","class","align-middle px-2",4,"matCellDef"],["matColumnDef","resultType"],["style","width: 30px;","mat-header-cell","","class","align-middle text-center",4,"matHeaderCellDef"],["style","width: 30px;","mat-cell","","class","align-middle text-end",4,"matCellDef"],["matColumnDef","resultPrefix"],["mat-header-cell","","class","align-middle text-center",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-end",4,"matCellDef"],["matColumnDef","resultName"],["mat-cell","","class","align-middle text-center px-2",4,"matCellDef"],["matColumnDef","resultSuffix"],["mat-cell","","class","align-middle text-start",4,"matCellDef"],["matColumnDef","resultUpdateTime"],["mat-cell","","class","align-middle text-center",4,"matCellDef"],["matColumnDef","resultStatus"],["matColumnDef","resultOwner"],["matColumnDef","resultDetail"],["mat-cell","","style","background-color: rgba(122, 168, 255, 0.1)",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"table-warning","table-primary","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","result-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"align-middle"],["mat-cell","",1,"link","align-middle","text-center","p-0"],[4,"ngIf"],[1,"fas","fa-angle-up"],[1,"fas","fa-angle-down"],["mat-header-cell","",1,"align-middle","text-center"],["mat-cell","",1,"align-middle","px-2"],[3,"routerLink",4,"ngIf"],["target","_blank",1,"ms-3",3,"routerLink"],[1,"fas","fa-external-link-alt"],["mat-header-cell","",1,"align-middle","text-center",2,"width","30px"],["mat-cell","",1,"align-middle","text-end",2,"width","30px"],[1,"col-md-9",3,"ngSwitch"],["class","fas fa-cogs fa-fw",4,"ngSwitchCase"],["class","fas fa-cog fa-fw",4,"ngSwitchCase"],["class","fas fa-puzzle-piece fa-fw",4,"ngSwitchCase"],["class","fas fa-server fa-fw",4,"ngSwitchCase"],[1,"fas","fa-cogs","fa-fw"],[1,"fas","fa-cog","fa-fw"],[1,"fas","fa-puzzle-piece","fa-fw"],[1,"fas","fa-server","fa-fw"],["mat-cell","",1,"align-middle","text-end"],[1,"text-muted"],["mat-cell","",1,"align-middle","text-center","px-2"],["mat-cell","",1,"align-middle","text-start"],["mat-cell","",1,"align-middle","text-center"],["class","text-info",4,"ngSwitchCase"],["class","text-primary",4,"ngSwitchCase"],["class","text-success",4,"ngSwitchCase"],["class","text-danger",4,"ngSwitchCase"],["class","text-warning",4,"ngSwitchCase"],[1,"text-info"],["aria-hidden","true",1,"fas","fa-hourglass-half","fa-fw"],[1,"text-primary"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin","fa-fw"],[1,"text-success"],["aria-hidden","true",1,"fas","fa-check","fa-fw"],[1,"text-danger"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],[1,"text-warning"],["aria-hidden","true",1,"fas","fa-trash-alt","fa-fw"],["mat-cell","",2,"background-color","rgba(122, 168, 255, 0.1)"],[1,"result-details","my-3"],[3,"theResult","currentUser"],["animationDuration","0ms",3,"selectedIndex","selectedTabChange"],["label","Standard output"],["matTabContent",""],["label","Standard error"],["mat-tab-label",""],["mat-button","",3,"click"],[1,"fas","fa-sync","fa-fx",2,"color","green"],[2,"width","100%","overflow","auto"],[3,"taskLogs","resultID"],[3,"text",4,"ngIf"],[3,"text"],[3,"click"],[3,"color","mode","value","bufferValue"],["mat-header-row",""],["mat-row","",3,"click"],["mat-row","",1,"result-detail-row"]],template:function(t,e){1&t&&(k.TgZ(0,"ol",0),k.TgZ(1,"li",1),k.TgZ(2,"a",2),k._uU(3,"Home"),k.qZA(),k.qZA(),k.TgZ(4,"li",1),k.TgZ(5,"a",2),k._uU(6,"Project List"),k.qZA(),k.qZA(),k.TgZ(7,"li",1),k.TgZ(8,"a",2),k._uU(9,"Recent activities"),k.qZA(),k.TgZ(10,"a",3),k._UZ(11,"i",4),k.qZA(),k.qZA(),k.qZA(),k.TgZ(12,"div",5),k.TgZ(13,"h3",6),k._uU(14,"Recent activities "),k.qZA(),k._UZ(15,"br"),k._UZ(16,"br"),k.TgZ(17,"button",7),k.NdJ("click",function(){return e.reloadActivities()}),k._UZ(18,"i",8),k._uU(19," Refresh "),k.qZA(),k.TgZ(20,"div",9),k.TgZ(21,"mat-paginator",10),k.NdJ("page",function(t){return e.onPageChange(t)}),k.qZA(),k.TgZ(22,"table",11,12),k.ynx(24,13),k.YNc(25,Ki,1,0,"th",14),k.YNc(26,en,3,3,"td",15),k.BQk(),k.ynx(27,16),k.YNc(28,nn,2,0,"th",17),k.YNc(29,sn,4,4,"td",18),k.BQk(),k.ynx(30,19),k.YNc(31,on,2,0,"th",20),k.YNc(32,gn,6,5,"td",21),k.BQk(),k.ynx(33,22),k.YNc(34,fn,2,0,"th",23),k.YNc(35,pn,3,1,"td",24),k.BQk(),k.ynx(36,25),k.YNc(37,hn,2,0,"th",17),k.YNc(38,Zn,5,7,"td",26),k.BQk(),k.ynx(39,27),k.YNc(40,xn,2,0,"th",23),k.YNc(41,vn,3,1,"td",28),k.BQk(),k.ynx(42,29),k.YNc(43,wn,2,0,"th",23),k.YNc(44,kn,2,1,"td",30),k.BQk(),k.ynx(45,31),k.YNc(46,bn,2,0,"th",23),k.YNc(47,Cn,7,6,"td",30),k.BQk(),k.ynx(48,32),k.YNc(49,Sn,2,0,"th",17),k.YNc(50,Un,3,1,"td",30),k.BQk(),k.ynx(51,33),k.YNc(52,Yn,4,4,"td",34),k.BQk(),k.YNc(53,jn,1,0,"tr",35),k.YNc(54,Mn,1,4,"tr",36),k.YNc(55,Ln,1,0,"tr",37),k.qZA(),k.TgZ(56,"mat-paginator",10),k.NdJ("page",function(t){return e.onPageChange(t)}),k.qZA(),k.qZA(),k.qZA()),2&t&&(k.xp6(2),k.Q6J("routerLink",k.DdM(16,On)),k.xp6(3),k.Q6J("routerLink",k.DdM(17,Bn)),k.xp6(3),k.Q6J("routerLink",k.DdM(18,Fn)),k.xp6(2),k.Q6J("routerLink",k.DdM(19,Fn)),k.xp6(11),k.Q6J("pageSizeOptions",k.DdM(20,$n))("pageSize",e.pageSize)("pageIndex",e.pageIndex)("length",e.totalCount),k.xp6(1),k.Q6J("dataSource",e.activities),k.xp6(31),k.Q6J("matHeaderRowDef",k.DdM(21,En)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(22,En)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(23,zn)),k.xp6(1),k.Q6J("pageSizeOptions",k.DdM(24,Hn))("pageSize",e.pageSize)("pageIndex",e.pageIndex)("length",e.totalCount))},directives:[D.yS,c.lW,w.NW,m.BZ,m.w1,m.fO,m.Dz,m.as,m.nj,m.ge,m.ev,l.O5,l.RF,l.n9,Zt,p.SP,p.uX,p.Vc,p.uD,ae,se.O,N,m.XQ,m.Gk],styles:["tr.result-detail-row[_ngcontent-%COMP%]{height:0}.result-details[_ngcontent-%COMP%]{overflow:hidden}"],data:{animation:[(0,vt.X$)("detailExpand",[(0,vt.SB)("collapsed",(0,vt.oB)({height:"0px",minHeight:"0",display:"none"})),(0,vt.SB)("expanded",(0,vt.oB)({height:"*",display:"block"})),(0,vt.eR)("expanded <=> collapsed",(0,vt.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t}();function Xn(t,e){if(1&t&&(k.TgZ(0,"span"),k._uU(1),k.qZA()),2&t){var i=k.oxw(2);k.xp6(1),k.hij(": ",i.currentProject.name,"")}}var Wn=function(t){return["/project",t,"info"]};function Kn(t,e){if(1&t&&(k.TgZ(0,"a",2),k._uU(1,"Project "),k.YNc(2,Xn,2,1,"span",7),k.qZA()),2&t){var i=k.oxw();k.Q6J("routerLink",k.VKq(2,Wn,i.currentProject.id)),k.xp6(2),k.Q6J("ngIf",i.currentProject)}}var Gn=function(t){return["/project",t,"result","list"]};function tr(t,e){if(1&t&&(k.TgZ(0,"li",10),k.TgZ(1,"a",2),k._uU(2,"Result List"),k.qZA(),k.TgZ(3,"a",11),k._UZ(4,"i",12),k.qZA(),k.qZA()),2&t){var i=k.oxw();k.xp6(1),k.Q6J("routerLink",k.VKq(2,Gn,i.currentProject.id)),k.xp6(2),k.Q6J("routerLink",k.VKq(4,Gn,i.currentProject.id))}}function er(t,e){1&t&&(k.TgZ(0,"li",10),k._uU(1,"Result List"),k.qZA())}function ir(t,e){1&t&&(k.TgZ(0,"div"),k._uU(1,"Loading... "),k._UZ(2,"i",13),k.qZA())}function nr(t,e){if(1&t&&(k.ynx(0),k.TgZ(1,"div",14),k.TgZ(2,"div",15),k.TgZ(3,"b"),k._uU(4,"Project name"),k.qZA(),k.qZA(),k.TgZ(5,"div",16),k.TgZ(6,"p",17),k._uU(7),k.qZA(),k.qZA(),k.qZA(),k.TgZ(8,"div",14),k.TgZ(9,"div",15),k.TgZ(10,"b"),k._uU(11,"Project description"),k.qZA(),k.qZA(),k.TgZ(12,"div",16),k.TgZ(13,"p",17),k._uU(14),k.qZA(),k.qZA(),k.qZA(),k.TgZ(15,"div",14),k.TgZ(16,"div",15),k.TgZ(17,"b"),k._uU(18,"Number of results"),k.qZA(),k.qZA(),k.TgZ(19,"div",16),k.TgZ(20,"p"),k._uU(21),k.qZA(),k.qZA(),k.qZA(),k.BQk()),2&t){var i=k.oxw();k.xp6(7),k.Oqu(null!=i.currentProject&&i.currentProject.name?null==i.currentProject?null:i.currentProject.name:"Unnamed"),k.xp6(7),k.Oqu(null!=i.currentProject&&i.currentProject.desc?null==i.currentProject?null:i.currentProject.desc:"No description"),k.xp6(7),k.AsE("",null==i.currentProject?null:i.currentProject.resultNumber," record(s), (",null==i.currentProject||null==i.currentProject.results?null:i.currentProject.results.length," including intermediate results)")}}function rr(t,e){1&t&&(k.ynx(0),k._uU(1,"s"),k.BQk())}function ar(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"button",51),k.NdJ("click",function(){return k.CHM(i),k.oxw(3).stopResultDialog()}),k.TgZ(1,"mat-icon"),k._uU(2,"stop"),k.qZA(),k.qZA()}}function sr(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"button",51),k.NdJ("click",function(){return k.CHM(i),k.oxw(3).deleteResultDialog()}),k.TgZ(1,"mat-icon"),k._uU(2,"delete"),k.qZA(),k.qZA()}}function or(t,e){if(1&t&&(k.TgZ(0,"div",14),k.TgZ(1,"div",20),k.TgZ(2,"span"),k._uU(3),k.YNc(4,rr,2,0,"ng-container",7),k.qZA(),k._UZ(5,"i",49),k.YNc(6,ar,3,0,"button",50),k.YNc(7,sr,3,0,"button",50),k.qZA(),k.qZA()),2&t){var i=k.oxw(2);k.xp6(3),k.hij("Selected ",i.selectedList.length," result"),k.xp6(1),k.Q6J("ngIf",i.selectedList.length>1),k.xp6(2),k.Q6J("ngIf",i.currentProject.privilege.canRun),k.xp6(1),k.Q6J("ngIf",i.currentProject.privilege.canDeleteResult)}}function lr(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"th",52),k.TgZ(1,"mat-checkbox",53,54),k.NdJ("change",function(t){return k.CHM(i),k.oxw(2).onAllCheckBoxChange(t)}),k.qZA(),k.qZA()}if(2&t){var n=k.oxw(2);k.xp6(1),k.Q6J("checked",n.selectedList.length===n.pageSize||n.selectedList.length===n.results.length)("indeterminate",n.selectedList.length>0&&n.selectedList.length<n.pageSize&&n.selectedList.length<n.results.length)}}function ur(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"td",55),k.TgZ(1,"mat-checkbox",56),k.NdJ("change",function(t){var e=k.CHM(i).$implicit;return k.oxw(2).onResultCheckBoxChange(t,e.id)})("click",function(t){return t.stopPropagation()}),k.qZA(),k.qZA()}if(2&t){var n=e.$implicit,r=k.oxw(2);k.uIk("rowspan",r.expandedResults.has(n.id)?2:1),k.xp6(1),k.Q6J("checked",r.selectedList.indexOf(n.id)>=0)}}function cr(t,e){1&t&&(k.TgZ(0,"th",57),k._uU(1,"Prefix"),k.qZA())}function dr(t,e){if(1&t&&(k.TgZ(0,"td",58),k.TgZ(1,"u",59),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(i.prefix)}}function gr(t,e){1&t&&(k.TgZ(0,"th",60),k._uU(1,"Result name"),k.qZA())}var fr=function(){return["/page"]},pr=function(t){return{result:t,proxy:!1}};function hr(t,e){if(1&t&&(k.TgZ(0,"a",67),k._UZ(1,"i",68),k.qZA()),2&t){var i=k.oxw().$implicit;k.Q6J("routerLink",k.DdM(2,fr))("queryParams",k.VKq(3,pr,i.id))}}var mr=function(t){return{result:t,proxy:"true"}};function Zr(t,e){if(1&t&&(k.TgZ(0,"a",69),k._UZ(1,"i",70),k.qZA()),2&t){var i=k.oxw().$implicit;k.Q6J("routerLink",k.DdM(2,fr))("queryParams",k.VKq(3,mr,i.id))}}var xr=function(t){return["/result",t,"info"]};function vr(t,e){if(1&t&&(k.TgZ(0,"td",61),k.YNc(1,hr,2,5,"a",62),k.YNc(2,Zr,2,5,"a",63),k.TgZ(3,"a",64),k._uU(4),k.qZA(),k.TgZ(5,"a",65),k._UZ(6,"span",66),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(2);k.xp6(1),k.Q6J("ngIf",n.currentProject.getValidResultPageKeys(null==n.taskID2Task[(null==i||null==i.task?null:i.task.id)||(null==i?null:i.task)]?null:n.taskID2Task[(null==i||null==i.task?null:i.task.id)||(null==i?null:i.task)].key).length>0),k.xp6(1),k.Q6J("ngIf",((null==i||null==i.task?null:i.task.proxy)||(null==n.taskID2Task[null==i?null:i.task]?null:n.taskID2Task[null==i?null:i.task].proxy))&&1==i.status),k.xp6(1),k.Q6J("routerLink",k.VKq(5,xr,i.id)),k.xp6(1),k.Oqu(null==i?null:i.name),k.xp6(1),k.Q6J("routerLink",k.VKq(7,xr,i.id))}}function wr(t,e){1&t&&(k.TgZ(0,"th",71),k._uU(1,"Type"),k.qZA())}function kr(t,e){1&t&&k._UZ(0,"i",78)}function br(t,e){1&t&&k._UZ(0,"i",79)}function Tr(t,e){1&t&&k._UZ(0,"i",80)}function yr(t,e){1&t&&k._UZ(0,"i",81)}function Ar(t,e){if(1&t&&(k.TgZ(0,"td",72),k.TgZ(1,"div",73),k.YNc(2,kr,1,0,"i",74),k.YNc(3,br,1,0,"i",75),k.YNc(4,Tr,1,0,"i",76),k.YNc(5,yr,1,0,"i",77),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngSwitch",null==i?null:i.type),k.xp6(1),k.Q6J("ngSwitchCase","workflow"),k.xp6(1),k.Q6J("ngSwitchCase","standard"),k.xp6(1),k.Q6J("ngSwitchCase","child"),k.xp6(1),k.Q6J("ngSwitchCase","system")}}function qr(t,e){1&t&&(k.TgZ(0,"th",57),k._uU(1,"Suffix"),k.qZA())}function _r(t,e){if(1&t&&(k.TgZ(0,"td",82),k.TgZ(1,"u",59),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(i.suffix)}}function Cr(t,e){1&t&&(k.TgZ(0,"th",57),k._uU(1,"Status"),k.qZA())}function Sr(t,e){1&t&&(k.TgZ(0,"p",90),k._UZ(1,"i",91),k.qZA())}function Ur(t,e){1&t&&(k.TgZ(0,"p",92),k._UZ(1,"i",93),k.qZA())}function Rr(t,e){1&t&&(k.TgZ(0,"p",94),k._UZ(1,"i",95),k.qZA())}function Nr(t,e){1&t&&(k.TgZ(0,"p",96),k._UZ(1,"i",97),k.qZA())}function Pr(t,e){1&t&&(k.TgZ(0,"p",98),k._UZ(1,"i",99),k.qZA())}function Jr(t,e){if(1&t&&(k.TgZ(0,"td",83),k.TgZ(1,"div",84),k.YNc(2,Sr,2,0,"p",85),k.YNc(3,Ur,2,0,"p",86),k.YNc(4,Rr,2,0,"p",87),k.YNc(5,Nr,2,0,"p",88),k.YNc(6,Pr,2,0,"p",89),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Q6J("ngSwitch",null==i?null:i.status),k.xp6(1),k.Q6J("ngSwitchCase",0),k.xp6(1),k.Q6J("ngSwitchCase",1),k.xp6(1),k.Q6J("ngSwitchCase",2),k.xp6(1),k.Q6J("ngSwitchCase",3),k.xp6(1),k.Q6J("ngSwitchCase",4)}}function Ir(t,e){1&t&&(k.TgZ(0,"th",57),k._uU(1,"Creation time"),k.qZA())}function Qr(t,e){if(1&t&&(k.TgZ(0,"td",83),k._uU(1),k.qZA()),2&t){var i=e.$implicit;k.xp6(1),k.Oqu(null==i||null==i.createdAt?null:i.createdAt.format("YYYY/MM/DD HH:mm:ss"))}}function Dr(t,e){1&t&&(k.TgZ(0,"th",57),k._uU(1,"Owner"),k.qZA())}function Yr(t,e){if(1&t&&(k.TgZ(0,"td",83),k.TgZ(1,"span"),k._uU(2),k.qZA(),k.qZA()),2&t){var i=e.$implicit;k.xp6(2),k.Oqu(null==i||null==i.owner?null:i.owner.name)}}function jr(t,e){if(1&t&&k._UZ(0,"chi-terminal",114),2&t){var i=k.oxw(4).$implicit;k.Q6J("text",null==i?null:i.stdOut)}}function Mr(t,e){if(1&t&&(k.TgZ(0,"div",111),k.YNc(1,jr,1,1,"chi-terminal",113),k.qZA()),2&t){var i=k.oxw(3).$implicit;k.xp6(1),k.Q6J("ngIf",i)}}function Lr(t,e){if(1&t&&k._UZ(0,"chi-terminal",114),2&t){var i=k.oxw(4).$implicit;k.Q6J("text",null==i?null:i.stdErr)}}function Or(t,e){if(1&t&&(k.TgZ(0,"div",111),k.YNc(1,Lr,1,1,"chi-terminal",113),k.qZA()),2&t){var i=k.oxw(3).$implicit;k.xp6(1),k.Q6J("ngIf",i)}}function Br(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",115),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(3).$implicit;return k.oxw(2).loadResultLogs(t.id)}),k._uU(1,"Task logs"),k.qZA()}}function Fr(t,e){if(1&t){var i=k.EpF();k.ynx(0),k._UZ(1,"display-arguments",103),k.TgZ(2,"mat-tab-group",104),k.NdJ("selectedTabChange",function(t){k.CHM(i);var e=k.oxw(2).$implicit;return k.oxw(2).onResultTabChange(t,e.id)}),k.TgZ(3,"mat-tab",105),k.YNc(4,Mr,2,1,"ng-template",106),k.qZA(),k.TgZ(5,"mat-tab",107),k.YNc(6,Or,2,1,"ng-template",106),k.qZA(),k.TgZ(7,"mat-tab"),k.YNc(8,Br,2,0,"ng-template",108),k.TgZ(9,"button",109),k.NdJ("click",function(){k.CHM(i);var t=k.oxw(2).$implicit;return k.oxw(2).loadResultLogs(t.id)}),k._UZ(10,"i",110),k._uU(11," Refresh logs "),k.qZA(),k.TgZ(12,"div",111),k._UZ(13,"chi-tasklog-viewer",112),k.qZA(),k.qZA(),k.qZA(),k.BQk()}if(2&t){var n=k.oxw(2).$implicit,r=k.oxw(2);k.xp6(1),k.Q6J("theResult",n)("currentUser",r.currentUser),k.xp6(1),k.Q6J("selectedIndex",0),k.xp6(11),k.Q6J("taskLogs",r.resultTaskLogs[n.id])("resultID",n.id)}}function $r(t,e){if(1&t&&k._UZ(0,"workflow-progress-display",118),2&t){var i=k.oxw(3).$implicit,n=k.oxw(2);k.Q6J("currentProject",n.currentProject)("currentResult",i)("taskID2Task",n.taskID2Task)}}function Er(t,e){if(1&t&&(k.ynx(0),k._UZ(1,"display-arguments",103),k._UZ(2,"mat-progress-bar",116),k.YNc(3,$r,1,3,"workflow-progress-display",117),k.BQk()),2&t){var i=k.oxw(2).$implicit,n=k.oxw(2);k.xp6(1),k.Q6J("theResult",i)("currentUser",n.currentUser),k.xp6(1),k.Q6J("color","primary")("mode","buffer")("value",n.workflowProgresses[i.id].value)("bufferValue",n.workflowProgresses[i.id].bufferValue),k.xp6(1),k.Q6J("ngIf",n.currentProject&&i&&n.expandedResults.has(i.id)&&n.taskID2Task)}}function zr(t,e){if(1&t&&(k.ynx(0),k.YNc(1,Fr,14,5,"ng-container",7),k.YNc(2,Er,4,7,"ng-container",7),k.BQk()),2&t){var i=k.oxw().$implicit;k.xp6(1),k.Q6J("ngIf","workflow"!==i.type),k.xp6(1),k.Q6J("ngIf","workflow"===i.type)}}function Hr(t,e){if(1&t&&(k.TgZ(0,"td",100),k.TgZ(1,"div",101),k.TgZ(2,"b"),k._UZ(3,"i",102),k._uU(4,"Description"),k.qZA(),k._uU(5,": "),k.TgZ(6,"p"),k._uU(7),k.qZA(),k.YNc(8,zr,3,2,"ng-container",7),k.qZA(),k.qZA()),2&t){var i=e.$implicit,n=k.oxw(2);k.uIk("colspan",n.expandedResults.has(i.id)?7:8),k.xp6(1),k.Q6J("@detailExpand",n.expandedResults.has(i.id)?"expanded":"collapsed"),k.xp6(6),k.Oqu(i.desc?i.desc:"No description"),k.xp6(1),k.Q6J("ngIf",n.expandedResults.has(i.id))}}function Vr(t,e){1&t&&k._UZ(0,"tr",119)}function Xr(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"tr",120),k.NdJ("click",function(){var t=k.CHM(i).$implicit;return k.oxw(2).toggleRow(t.id)}),k.qZA()}if(2&t){var n=e.$implicit,r=k.oxw(2);k.ekj("table-primary",r.expandedResults.has(n.id))}}function Wr(t,e){1&t&&k._UZ(0,"tr",121)}var Kr=function(){return[10,30,50,100,300,500]},Gr=function(){return["resultCheckbox","resultType","resultPrefix","resultName","resultSuffix","resultStatus","resultCreationTime","resultOwner"]},ta=function(){return["resultDetail"]};function ea(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",18),k.YNc(1,or,8,4,"div",19),k.TgZ(2,"div",14),k.TgZ(3,"div",20,21),k.TgZ(5,"mat-paginator",22),k.NdJ("page",function(t){return k.CHM(i),k.oxw().onPageChange(t)}),k.qZA(),k.TgZ(6,"div",23),k.TgZ(7,"table",24),k.NdJ("matSortChange",function(t){return k.CHM(i),k.oxw().sortData(t)}),k.ALo(8,"slice"),k.ynx(9,25),k.YNc(10,lr,3,2,"th",26),k.YNc(11,ur,2,2,"td",27),k.BQk(),k.ynx(12,28),k.YNc(13,cr,2,0,"th",29),k.YNc(14,dr,3,1,"td",30),k.BQk(),k.ynx(15,31),k.YNc(16,gr,2,0,"th",32),k.YNc(17,vr,7,9,"td",33),k.BQk(),k.ynx(18,34),k.YNc(19,wr,2,0,"th",35),k.YNc(20,Ar,6,5,"td",36),k.BQk(),k.ynx(21,37),k.YNc(22,qr,2,0,"th",38),k.YNc(23,_r,3,1,"td",39),k.BQk(),k.ynx(24,40),k.YNc(25,Cr,2,0,"th",29),k.YNc(26,Jr,7,6,"td",41),k.BQk(),k.ynx(27,42),k.YNc(28,Ir,2,0,"th",38),k.YNc(29,Qr,2,1,"td",41),k.BQk(),k.ynx(30,43),k.YNc(31,Dr,2,0,"th",38),k.YNc(32,Yr,3,1,"td",41),k.BQk(),k.ynx(33,44),k.YNc(34,Hr,9,4,"td",45),k.BQk(),k.YNc(35,Vr,1,0,"tr",46),k.YNc(36,Xr,1,2,"tr",47),k.YNc(37,Wr,1,0,"tr",48),k.qZA(),k.qZA(),k.TgZ(38,"mat-paginator",22),k.NdJ("page",function(t){return k.CHM(i),k.oxw().onPageChange(t)}),k.qZA(),k.qZA(),k.qZA(),k.qZA()}if(2&t){var n=k.oxw();k.xp6(1),k.Q6J("ngIf",n.selectedList.length>0),k.xp6(4),k.Q6J("length",n.results.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",k.DdM(17,Kr)),k.xp6(2),k.Q6J("dataSource",k.Dn7(8,13,n.results,n.pageIndex*n.pageSize,(n.pageIndex+1)*n.pageSize)),k.xp6(28),k.Q6J("matHeaderRowDef",k.DdM(18,Gr)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(19,Gr)),k.xp6(1),k.Q6J("matRowDefColumns",k.DdM(20,ta)),k.xp6(1),k.Q6J("length",n.results.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",k.DdM(21,Kr))}}function ia(t,e){1&t&&k._UZ(0,"i",131)}function na(t,e){1&t&&k._UZ(0,"i",132)}var ra=function(t){return["/project",t,"result","creation"]};function aa(t,e){if(1&t&&(k.ynx(0),k.TgZ(1,"a",128),k._UZ(2,"i",133),k.TgZ(3,"span",130),k._uU(4,"Perform analysis"),k.qZA(),k.TgZ(5,"span",127),k._uU(6,"\u276f"),k.qZA(),k.qZA(),k._UZ(7,"br"),k.BQk()),2&t){var i=k.oxw(2);k.xp6(1),k.Q6J("routerLink",k.VKq(3,ra,i.currentProject.id)),k.xp6(2),k.ekj("active",i.showRightButtonContent)}}var sa=function(t){return["/project",t,"dataFile","list"]};function oa(t,e){if(1&t){var i=k.EpF();k.TgZ(0,"div",122),k.TgZ(1,"a",123),k.NdJ("click",function(){k.CHM(i);var t=k.oxw();return t.showRightButtonContent=!t.showRightButtonContent}),k.YNc(2,ia,1,0,"i",124),k.YNc(3,na,1,0,"i",125),k.TgZ(4,"span",126),k._uU(5,"MENU"),k.qZA(),k.TgZ(6,"span",127),k._uU(7,"\u276f"),k.qZA(),k.qZA(),k._UZ(8,"br"),k.YNc(9,aa,8,5,"ng-container",7),k.TgZ(10,"a",128),k._UZ(11,"i",129),k.TgZ(12,"span",130),k._uU(13,"Data files"),k.qZA(),k.TgZ(14,"span",127),k._uU(15,"\u276f"),k.qZA(),k.qZA(),k._UZ(16,"br"),k.qZA()}if(2&t){var n=k.oxw();k.Q6J("@rightButtonState",n.showRightButtonContent?"active":"inactive"),k.xp6(2),k.Q6J("ngIf",n.showRightButtonContent),k.xp6(1),k.Q6J("ngIf",!n.showRightButtonContent),k.xp6(1),k.ekj("active",n.showRightButtonContent),k.xp6(5),k.Q6J("ngIf",n.currentProject.privilege.canRun),k.xp6(1),k.Q6J("routerLink",k.VKq(9,sa,n.currentProject.id)),k.xp6(2),k.ekj("active",n.showRightButtonContent)}}var la=function(){return["/home"]},ua=function(){return["/project/list"]},ca=D.Bz.forChild([{path:"list",component:function(){var t=function(){function t(e,i,n,r,a,o,l){s(this,t),this.projectService=e,this.accountService=i,this.router=n,this.route=r,this.dialog=a,this.taskService=o,this.systemService=l,this._viewControls={resultViewMode:"table",isResultDeleting:!1,confirmDelete:"",sortField:"createdAt",sortDirection:"desc",expandContent:{}},this.pageSize=30,this.pageIndex=0,this.selectedList=[],this.showRightButtonContent=!1,this.expandedResults=new Set,this.taskID2Task={},this.workflowProgresses={},this.resultTaskLogs={},this.loadedResultIDs=new Set,this._subs=[]}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.systemService.maintainRightSidebarStatus(),this._subs.push(this.projectService.currentProject$.subscribe(function(e){setTimeout(function(){var i;e&&e.id!==(null===(i=t.currentProject)||void 0===i?void 0:i.id)&&(t.currentProject=e,t.taskService.loadTasks(t.currentProject.packages.map(function(t){return t.id})))},100)})),this._subs.push(this.accountService.currentUser$.subscribe(function(e){return t.currentUser=e})),this._subs.push(this.taskService.taskList$.subscribe(function(e){if(e&&e.length>0)for(var i=0;i<e.length;i++){var n=e[i];t.taskID2Task[n.id]=n}})),this.route.paramMap.subscribe(function(e){var i=e.get("pid");i&&t.projectService.setCurrentProject(i)})}},{key:"loadingResultInfo",value:function(t){var e=this;if(!this.loadedResultIDs.has(t))var i=this.projectService.loadResultInfo(t).subscribe(function(n){i.unsubscribe(),e.loadedResultIDs.add(t)})}},{key:"goToNewResultPage",value:function(){this.currentProject&&this.router.navigate(["/project",this.currentProject.id,"result","creation"])}},{key:"gotoResult",value:function(t,e){t&&t.id&&this.router.navigate(["/result",t.id,"info"],e?{queryParams:{edit:1}}:{})}},{key:"onPageChange",value:function(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize}},{key:"results",get:function(){var t=this;if(this.currentProject&&this.currentProject.results){var e=this.currentProject.results.slice(0),i=this._viewControls.sortField;"createdAt"===i?(e.sort(function(t,e){return M(t[i]).isBefore(e[i])?-1:1}),"desc"===this._viewControls.sortDirection&&e.reverse()):e=(0,wt.X)(e,"owner"===i?[function(t){return t.owner.name}]:[function(t){return t[i]}],this._viewControls.sortDirection);var n=e.filter(function(t){return!t.parent});return n.forEach(function(e){t.workflowProgresses[e.id]=2===e.status?{value:100,bufferValue:0}:t.calculateWorkflowProgress(e)}),n}return[]}},{key:"calculateWorkflowProgress",value:function(t){if("workflow"!==t.type)return{value:0,bufferValue:0};for(var e=t.task&&Array.isArray(t.task.mapper)?t.task.mapper.length:t.taskSnapshot.mapper.length,i=t.children||[],n=[],r=0;r<e;r++)if(Array.isArray(t.task.mapper)){var a=t.task.mapper[r].length,s=Array.isArray(i[r])?i[r].filter(function(t){return!!t}):[];if(0===s.length)break;n[r]=0,s.length===a&&r<e-1?n[r]=2:0===s.length&&r>=1&&2===n[r-1]?n[r-1]=1:s.length===a&&r===e-1&&2!==t.status&&(n[r]=1)}return{value:100*n.filter(function(t){return 2===t}).length/e,bufferValue:100*n.filter(function(t){return t<=1}).length/e}}},{key:"onAllCheckBoxChange",value:function(t){this.selectedList=t.checked?this.results.slice(this.pageIndex*this.pageSize,(this.pageIndex+1)*this.pageSize).map(function(t){return t.id}):[]}},{key:"onResultTabChange",value:function(t,e){2===t.index&&this.loadResultLogs(e)}},{key:"onResultCheckBoxChange",value:function(t,e){if(t.checked&&this.selectedList.indexOf(e)<0)this.selectedList.push(e);else if(!t.checked){var i=this.selectedList.indexOf(e);i>=0&&this.selectedList.splice(i,1)}}},{key:"sortColumn",value:function(t){this._viewControls.sortField===t?this._viewControls.sortDirection="desc"===this._viewControls.sortDirection?"asc":"desc":(this._viewControls.sortField=t,this._viewControls.sortDirection="asc")}},{key:"loadResultLogs",value:function(t){var e=this,i=this.projectService.getResultLogs(t).subscribe(function(n){i.unsubscribe();var r=n.success.split("\n").map(function(t){return t.split("\t")}),a=r[0];e.resultTaskLogs[t]=r.slice(1).map(function(t,e){var i={index:e};return t.forEach(function(t,e){return i[a[e]]=t}),new L(i)}).filter(function(t){return!(""===t.process&&"undefined"===t.taskName)})})}},{key:"deleteResult",value:function(t,e){var i=this;this._viewControls.isResultDeleting=!0,t.status=4;var n=this.projectService.deleteResult(t).subscribe(function(){n.unsubscribe(),i._viewControls.isResultDeleting=!1})}},{key:"batchDeleteResult",value:function(t){if(this.currentProject){this.selectedList=[];var e=this.projectService.batchRemoveResult(t,this.currentProject.id).subscribe(function(){return e.unsubscribe()})}}},{key:"stopResult",value:function(t,e){var i=this.projectService.stopResult(t).subscribe(function(){return i.unsubscribe()})}},{key:"batchStopResults",value:function(t){if(this.currentProject){this.selectedList=[];var e=this.projectService.batchStopResult(t,this.currentProject.id).subscribe(function(){return e.unsubscribe()})}}},{key:"stopResultDialog",value:function(t){var e=this,i=this.dialog.open(F.N,{disableClose:!1});void 0!==t?(i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to stop the processes <strong>'.concat(t.name,"</strong>?</h4>"),desc:'<span class="text-danger">This will stop the processes, name: <b>'.concat(t.name,"</b><br>This cannot be undone. Make sure this is something you really want to do!</span><br>")}),i.afterClosed().subscribe(function(i){i&&e.stopResult(t,i)})):(i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to stop the selected\''.concat(this.selectedList.length,"' result(s)?</h4>"),desc:'<span class="text-danger">This action will stop these tasks and cannot be undone.Make sure this is something you really want to do!</span><br>'}),i.afterClosed().subscribe(function(t){t&&e.batchStopResults(e.selectedList)}))}},{key:"deleteResultDialog",value:function(t){var e=this,i=this.dialog.open(F.N,{disableClose:!1});void 0!==t?(i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to delete the result <strong>'.concat(t.name,"</strong>?</h4>"),desc:'<span class="text-danger">This will delete the result, name: <b>'.concat(t.name,"</b>, and all the associated outputs. <br>This cannot be undone. Make sure this is something you really want to do!</span><br>")}),i.afterClosed().subscribe(function(i){i&&e.deleteResult(t,i)})):(i.componentInstance.setOptions({title:'<h4 class="modal-title text-danger">Are you sure you want to delete the selected\''.concat(this.selectedList.length,"' result(s)?</h4>"),desc:'<span class="text-danger">This action will delete these results and all their associated outputs. <br>This cannot be undone. Make sure this is something you really want to do!</span><br>'}),i.afterClosed().subscribe(function(t){t&&e.batchDeleteResult(e.selectedList)}))}},{key:"toggleRow",value:function(t){this.expandedResults.has(t)?this.expandedResults.delete(t):(this.expandedResults.add(t),this.loadingResultInfo(t))}},{key:"sortData",value:function(t){var e="createdAt";switch(t.active){case"resultName":e="name";break;case"resultPrefix":e="prefix";break;case"resultSuffix":e="suffix";break;case"resultStatus":e="status";break;case"resultType":e="type";break;case"resultCreationTime":e="createdAt";break;case"resultOwner":e="owner"}t.direction?(this._viewControls.sortDirection=t.direction,this._viewControls.sortField=e):(this._viewControls.sortDirection="desc",this._viewControls.sortField="createdAt")}},{key:"ngOnDestroy",value:function(){this._subs.forEach(function(t){return t.unsubscribe()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(k.Y36(E.Y),k.Y36(W.B),k.Y36(D.F0),k.Y36(D.gz),k.Y36(V.uw),k.Y36(H.M),k.Y36(X.o))},t.\u0275cmp=k.Xpm({type:t,selectors:[["project-result-list"]],decls:20,vars:11,consts:[[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[3,"routerLink",4,"ngIf"],["class","breadcrumb-item active",4,"ngIf"],[1,"bdp-main-container"],[1,"chi-header"],[4,"ngIf"],["class","container-fluid",4,"ngIf"],["class","chi-right-menu",4,"ngIf"],[1,"breadcrumb-item","active"],["target","_blank",3,"routerLink"],[1,"fas","fa-external-link-alt","ms-3"],[1,"fas","fa-circle-notch","fa-fw","fa-spin","fa-lg"],[1,"row"],[1,"col-md-3","col-lg-2"],[1,"col-md-9","col-lg-10"],[2,"word-break","break-all","width","100%"],[1,"container-fluid"],["class","row",4,"ngIf"],[1,"col-12"],["tableWidth",""],[2,"background-color","rgba(255,255, 255, 0.7)","border","thin solid darkgray",3,"length","pageSize","pageIndex","pageSizeOptions","page"],[1,"table-responsive",2,"width","100%"],["mat-table","","multiTemplateDataRows","","matSort","",1,"table","table-hover","table-striped","table-bordered",3,"dataSource","matSortChange"],["matColumnDef","resultCheckbox"],["mat-header-cell","","class","align-middle text-center","style","padding: 2px;",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-center","style","padding: 2px;",4,"matCellDef"],["matColumnDef","resultPrefix"],["mat-header-cell","","mat-sort-header","","class","align-middle text-center",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-end",4,"matCellDef"],["matColumnDef","resultName"],["mat-header-cell","","mat-sort-header","","class","align-middle  text-start",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-start px-2",4,"matCellDef"],["matColumnDef","resultType"],["style","width: 30px;","mat-header-cell","","mat-sort-header","","class","align-middle text-center",4,"matHeaderCellDef"],["style","width: 30px;","mat-cell","","class","align-middle text-end",4,"matCellDef"],["matColumnDef","resultSuffix"],["mat-header-cell","","mat-sort-header","","class","align-middle  text-center",4,"matHeaderCellDef"],["mat-cell","","class","align-middle text-start",4,"matCellDef"],["matColumnDef","resultStatus"],["mat-cell","","class","align-middle text-center",4,"matCellDef"],["matColumnDef","resultCreationTime"],["matColumnDef","resultOwner"],["matColumnDef","resultDetail"],["mat-cell","","style","background-color: rgba(122, 168, 255, 0.1);","class","px-3",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"table-primary","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","result-detail-row",4,"matRowDef","matRowDefColumns"],[1,"fa","fa-angle-double-right","ms-4","fa-lg"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click"],["mat-header-cell","",1,"align-middle","text-center",2,"padding","2px"],[3,"checked","indeterminate","change"],["allCheckBox",""],["mat-cell","",1,"align-middle","text-center",2,"padding","2px"],["color","primary",3,"checked","change","click"],["mat-header-cell","","mat-sort-header","",1,"align-middle","text-center"],["mat-cell","",1,"align-middle","text-end"],[1,"text-muted"],["mat-header-cell","","mat-sort-header","",1,"align-middle","text-start"],["mat-cell","",1,"align-middle","text-start","px-2"],["mat-icon-button","","color","primary","matTooltip","Result Page",3,"routerLink","queryParams",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","Proxy Page",3,"routerLink","queryParams",4,"ngIf"],[1,"ms-3",3,"routerLink"],["target","_blank",1,"ms-3",3,"routerLink"],[1,"fas","fa-external-link-alt"],["mat-icon-button","","color","primary","matTooltip","Result Page",3,"routerLink","queryParams"],[1,"fas","fa-scroll","fa-fw","fa-lg"],["mat-icon-button","","color","primary","matTooltip","Proxy Page",3,"routerLink","queryParams"],[1,"fas","fa-network-wired","fa-fw","fa-lg"],["mat-header-cell","","mat-sort-header","",1,"align-middle","text-center",2,"width","30px"],["mat-cell","",1,"align-middle","text-end",2,"width","30px"],[1,"col-md-9",3,"ngSwitch"],["class","fas fa-cogs fa-fw",4,"ngSwitchCase"],["class","fas fa-cog fa-fw",4,"ngSwitchCase"],["class","fas fa-puzzle-piece fa-fw",4,"ngSwitchCase"],["class","fas fa-server fa-fw",4,"ngSwitchCase"],[1,"fas","fa-cogs","fa-fw"],[1,"fas","fa-cog","fa-fw"],[1,"fas","fa-puzzle-piece","fa-fw"],[1,"fas","fa-server","fa-fw"],["mat-cell","",1,"align-middle","text-start"],["mat-cell","",1,"align-middle","text-center"],[3,"ngSwitch"],["class","text-info",4,"ngSwitchCase"],["class","text-primary",4,"ngSwitchCase"],["class","text-success",4,"ngSwitchCase"],["class","text-danger",4,"ngSwitchCase"],["class","text-warning",4,"ngSwitchCase"],[1,"text-info"],["aria-hidden","true",1,"fas","fa-hourglass-half","fa-fw"],[1,"text-primary"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin","fa-fw"],[1,"text-success"],["aria-hidden","true",1,"fas","fa-check","fa-fw"],[1,"text-danger"],["aria-hidden","true",1,"fas","fa-times","fa-fw"],[1,"text-warning"],["aria-hidden","true",1,"fas","fa-trash-alt","fa-fw"],["mat-cell","",1,"px-3",2,"background-color","rgba(122, 168, 255, 0.1)"],[1,"result-details","my-3"],[1,"fas","fa-angle-right","me-2"],[3,"theResult","currentUser"],[2,"width","100%",3,"selectedIndex","selectedTabChange"],["label","Standard output"],["matTabContent",""],["label","Standard error"],["mat-tab-label",""],["mat-button","",3,"click"],[1,"fas","fa-sync","fa-fx",2,"color","green"],[2,"width","100%","overflow","auto"],[3,"taskLogs","resultID"],[3,"text",4,"ngIf"],[3,"text"],[3,"click"],[3,"color","mode","value","bufferValue"],["style","width: 100%;",3,"currentProject","currentResult","taskID2Task",4,"ngIf"],[2,"width","100%",3,"currentProject","currentResult","taskID2Task"],["mat-header-row",""],["mat-row","",3,"click"],["mat-row","",1,"result-detail-row"],[1,"chi-right-menu"],[1,"chi-rbtn",3,"click"],["class","fa fa-angle-right fa-fw",4,"ngIf"],["class","fa fa-angle-left fa-fw",4,"ngIf"],[1,"chi-rbtn-content","ms-2"],[1,"chi-rbtn-arrow"],[1,"chi-rbtn",3,"routerLink"],[1,"far","fa-file","fa-fw"],[1,"chi-rbtn-content"],[1,"fa","fa-angle-right","fa-fw"],[1,"fa","fa-angle-left","fa-fw"],[1,"fa","fa-play","fa-fw"]],template:function(t,e){1&t&&(k.TgZ(0,"ol",0),k.TgZ(1,"li",1),k.TgZ(2,"a",2),k._uU(3,"Home"),k.qZA(),k.qZA(),k.TgZ(4,"li",1),k.TgZ(5,"a",2),k._uU(6,"Project List"),k.qZA(),k.qZA(),k.TgZ(7,"li",1),k.YNc(8,Kn,3,4,"a",3),k.qZA(),k.YNc(9,tr,5,6,"li",4),k.YNc(10,er,2,0,"li",4),k.qZA(),k.TgZ(11,"div",5),k.TgZ(12,"h3",6),k._uU(13,"Results in the Project: "),k.qZA(),k._UZ(14,"br"),k._UZ(15,"br"),k.YNc(16,ir,3,0,"div",7),k.YNc(17,nr,22,4,"ng-container",7),k.qZA(),k.YNc(18,ea,39,22,"div",8),k.YNc(19,oa,17,11,"div",9)),2&t&&(k.xp6(2),k.Q6J("routerLink",k.DdM(9,la)),k.xp6(3),k.Q6J("routerLink",k.DdM(10,ua)),k.xp6(3),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",!e.currentProject),k.xp6(6),k.Q6J("ngIf",!e.currentProject),k.xp6(1),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",e.currentProject),k.xp6(1),k.Q6J("ngIf",e.currentProject))},directives:[D.yS,l.O5,w.NW,m.BZ,Z.YE,m.w1,m.fO,m.Dz,m.as,m.nj,c.lW,h.Hw,m.ge,I.oG,m.ev,Z.nU,c.zs,x.gM,l.RF,l.n9,Zt,p.SP,p.uX,p.Vc,p.uD,ae,se.O,N,Ze,m.XQ,m.Gk],pipes:[l.OU],styles:[".result-details[_ngcontent-%COMP%]{overflow:hidden;display:none}tr.result-detail-row[_ngcontent-%COMP%]{height:0;width:100%}[_nghost-%COMP%]     .mat-sort-header-container{display:flex;justify-content:center}"],data:{animation:[Y.M,(0,vt.X$)("detailExpand",[(0,vt.SB)("collapsed",(0,vt.oB)({height:"0px",padding:"0px",minHeight:"0",display:"none"})),(0,vt.SB)("expanded",(0,vt.oB)({height:"*",padding:"5px",display:"block"})),(0,vt.eR)("expanded <=> collapsed",(0,vt.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t}(),canActivate:[Xi.P]},{path:":resultId/info",component:Vi,canActivate:[Xi.P]},{path:"activities",component:Vn,canActivate:[Xi.P]}]),da=[],ga=a(98626),fa=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({providers:[],imports:[[l.ez,D.Bz,g.To,x.AV]]}),t}(),pa=a(49756),ha=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({providers:[],imports:[[l.ez,u.u5,D.Bz,m.p0,Z.JX,w.TU,V.Is,c.ot,d.vV,J]]}),t}(),ma=a(76605),Za=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({providers:[],imports:[[l.ez,u.u5,x.AV]]}),t}(),xa=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({providers:[da],imports:[[l.ez,u.u5,f.c,p.Nh,c.ot,d.vV,g.To,h.Ps,m.p0,Z.JX,x.AV,I.p9,v.t,ha,pa.E,Q.T,w.TU,J,Za,ga.w,fa,ma.c,ca]]}),t}()},85855:function(t,e,i){i.d(e,{T:function(){return g}});var n,r=i(58846),a=i(38583),o=i(3679),l=i(51095),u=i(93738),c=i(58341),d=i(37716),g=((n=function t(){s(this,t)}).\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[],imports:[[a.ez,o.u5,r.Bz,l.ot,u.QW,c.Hi]]}),n)}}])}();